<!doctype html>
<html lang="az" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="canonical" href="https://www.eduplan.az/timetable.html" />
    <meta name="keywords" content="DÉ™rs cÉ™dvÉ™linin hazÄ±rlanmasÄ±, DÉ™rs cÉ™dvÉ™li qurmaq Ã¼Ã§Ã¼n proqram, Orta mÉ™ktÉ™blÉ™rdÉ™ dÉ™rs cÉ™dvÉ™li, DÉ™rs cÉ™dvÉ™li proqramÄ±, dÉ™rs cÉ™dvÉ™li qurmaq Ã¼Ã§Ã¼n proqram yÃ¼klÉ™" />
  <meta name="description" content="AzÉ™rbaycan orta mÉ™ktÉ™blÉ™ri Ã¼Ã§Ã¼n onlayn DÉ™rs cÉ™dvÉ™li hazÄ±rlayÄ±cÄ± â€” mÃ¼É™llim, sinif vÉ™ fÉ™nn mÉ™lumatlarÄ±nÄ± daxil edin, sistem avtomatik cÉ™dvÉ™l qursun.">
  <meta name="robots" content="index, follow" />
  <meta name="author" content="EduPlan.az" />
  <meta name="language" content="az" />
  <meta name="format-detection" content="telephone=no" />
  <title>DÉ™rs cÉ™dvÉ™li hazÄ±rlayÄ±cÄ± â€” EduPlan</title>
  <meta name="theme-color" content="#ffffff" id="theme-color" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="DÉ™rs cÉ™dvÉ™li hazÄ±rlayÄ±cÄ± â€” EduPlan" />
  <meta property="og:description" content="MÃ¼É™llim vÉ™ sinif mÉ™lumatlarÄ±nÄ± daxil edin, sistem avtomatik dÉ™rs cÉ™dvÉ™li hazÄ±rlasÄ±n." />
  <meta property="og:image" content="https://www.eduplan.az/assets/og-image.jpg" />
  <meta property="og:url" content="https://www.eduplan.az/timetable.html" />
  <meta property="og:site_name" content="EduPlan" />

  <link rel="icon" href="favicon.ico" sizes="any">
  <link rel="icon" type="image/svg+xml" href="logo.svg">
  <link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="favicon-48x48.png" sizes="48x48">
  <link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="android-chrome-512x512.png" sizes="512x512">
  <link rel="apple-touch-icon" href="apple-touch-icon.png" sizes="180x180">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#0ea5e9">
  <link rel="manifest" href="manifest.webmanifest">

  <!-- Tema: FOUC olmasÄ±n (Tailwind-dÉ™n É™vvÉ™l) -->
  <script>
    (function () {
      try {
        const saved = localStorage.getItem('theme');
        const systemDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const theme = (saved === 'dark' || saved === 'light') ? saved : (systemDark ? 'dark' : 'light');

        const root = document.documentElement;
        root.classList.toggle('dark', theme === 'dark');
        root.dataset.theme = theme;

        const meta = document.getElementById('theme-color');
        if (meta) meta.setAttribute('content', theme === 'dark' ? '#0b1220' : '#ffffff');
      } catch (e) {}
    })();
  </script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>

  <style>
    html, body { overflow-x: hidden; }
    :root { color-scheme: light; }
    html.dark { color-scheme: dark; }
    html { scroll-padding-top: 80px; }

    .ep-btn-primary{ background: linear-gradient(90deg,#1e3a8a 0%,#4f46e5 50%,#9333ea 100%); }
    html.dark .ep-btn-primary{ background: linear-gradient(90deg,#312e81 0%,#4338ca 50%,#7e22ce 100%); }

    /* ==== Form controls ==== */
    :root{
      --ep-field-h: 42px;
      --ep-field-h-sm: 36px;

      --ep-radius-lg: 1rem;
      --ep-radius-sm: .95rem;

      /* ===== Reklam relslÉ™ri ===== */
      --ep-rail-w: clamp(160px, 14vw, 300px);
      --ep-rail-min-h: 600px;
      --ep-rail-gap: 24px;

      /* MÉ™rkÉ™z sÃ¼tunun max eni (reklam olanda) */
      --ep-center-max: 1100px;

      /* Reklam olanda sÉ™hifÉ™nin max eni */
      --ep-shell-max: 1600px;

      /* Header max-w-7xl = 80rem */
      --ep-frame-max: 80rem;
    }

    input[type="text"], input[type="number"], select {
      width: 100%;
      border-radius: var(--ep-radius-lg);
      border: 1px solid rgba(226,232,240,.75);
      background-color: rgba(255,255,255,.6);
      padding: .58rem .9rem;
      font-size: 13px;
      line-height: 1.35;
      min-height: var(--ep-field-h);
      outline: none;
      transition: background-color .15s ease, border-color .15s ease, box-shadow .15s ease;
    }

    html.dark input[type="text"], html.dark input[type="number"], html.dark select {
      border-color: rgba(30,41,59,.7);
      background-color: rgba(255,255,255,.05);
      color: rgb(226,232,240);
    }

    input[type="text"]::placeholder, input[type="number"]::placeholder { color: rgb(148,163,184); }

    input[type="text"]:focus, input[type="number"]:focus, select:focus{
      border-color: rgb(99,102,241);
      box-shadow: 0 0 0 3px rgba(99,102,241,.22);
    }

    select{
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
      padding-right: 2.25rem;
      background-repeat: no-repeat;
      background-position: right .75rem center;
      background-size: 1rem 1rem;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M6 8l4 4 4-4' stroke='%23334155' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    }
    html.dark select{
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M6 8l4 4 4-4' stroke='%23cbd5e1' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
    }

    select option, select optgroup{
      color: #0f172a;
      background-color: #ffffff;
    }

    input[type="checkbox"]{ accent-color: rgb(99,102,241); }

    .section-title{
      font-size:.8rem;
      font-weight:700;
      letter-spacing:.06em;
      text-transform:uppercase;
      color: rgb(100 116 139);
    }
    html.dark .section-title{ color: rgb(148 163 184); }

    /* Config table */
    table.config-table{
      width:100%;
      border-collapse:separate;
      border-spacing:0 8px;
      font-size:.78rem;
    }
    table.config-table th{
      text-align:left;
      font-weight:600;
      color: rgb(100 116 139);
      padding: 4px 6px;
      font-size: .72rem;
      white-space: normal;
      line-height: 1.15;
    }
    html.dark table.config-table th{ color: rgb(148 163 184); }
    table.config-table td{
      padding: 4px 6px;
      vertical-align: top;
      overflow: visible;
    }

    table.config-table input, table.config-table select{
      padding: .44rem .64rem;
      border-radius: var(--ep-radius-sm);
      min-height: var(--ep-field-h-sm);
      font-size: 12.5px;
      line-height: 1.35;
    }

    /* ===== Teacher table ===== */
    #teacherTable{ table-layout: fixed; width: 100%; min-width: 0; }
    #teacherTable th:nth-child(1), #teacherTable td:nth-child(1){ width: 22%; }
    #teacherTable th:nth-child(2), #teacherTable td:nth-child(2){ width: 9%; }
    #teacherTable th:nth-child(3), #teacherTable td:nth-child(3){ width: 10%; }
    #teacherTable th:nth-child(4), #teacherTable td:nth-child(4){ width: 9%; }
    #teacherTable th:nth-child(5), #teacherTable td:nth-child(5){ width: 6%; }
    #teacherTable th:nth-child(6), #teacherTable td:nth-child(6){ width: 7%; }
    #teacherTable th:nth-child(7), #teacherTable td:nth-child(7){ width: 32%; }
    #teacherTable th:nth-child(8), #teacherTable td:nth-child(8){ width: 5%; }

    .t-days{
      display:flex;
      flex-wrap:wrap;
      gap: 6px;
      font-size: 11px;
      line-height: 1.2;
    }
    .t-days label{
      display:inline-flex;
      align-items:center;
      gap:4px;
      white-space: nowrap;
    }

    /* Class / Lesson tables */
    #classTable, #lessonTable{ table-layout: fixed; width:100%; min-width:0; }
    #classTable th:nth-child(1), #classTable td:nth-child(1){ width: 18%; }
    #classTable th:nth-child(2), #classTable td:nth-child(2){ width: 28%; }
    #classTable th:nth-child(3), #classTable td:nth-child(3){ width: 18%; }
    #classTable th:nth-child(4), #classTable td:nth-child(4){ width: 26%; }
    #classTable th:nth-child(5), #classTable td:nth-child(5){ width: 10%; }

    #lessonTable th:nth-child(1), #lessonTable td:nth-child(1){ width: 16%; }
    #lessonTable th:nth-child(2), #lessonTable td:nth-child(2){ width: 30%; }
    #lessonTable th:nth-child(3), #lessonTable td:nth-child(3){ width: 24%; }
    #lessonTable th:nth-child(4), #lessonTable td:nth-child(4){ width: 14%; }
    #lessonTable th:nth-child(5), #lessonTable td:nth-child(5){ width: 7%; }
    #lessonTable th:nth-child(6), #lessonTable td:nth-child(6){ width: 7%; }
    #lessonTable th:nth-child(7), #lessonTable td:nth-child(7){ width: 2%; }

    /* Tabs */
    .tab-btn{
      border-radius: 9999px;
      padding: .3rem .8rem;
      font-size: .78rem;
      border: 1px solid transparent;
      background: transparent;
      cursor: pointer;
      white-space: nowrap;
      transition: background-color .15s ease, border-color .15s ease, color .15s ease;
    }
    .tab-btn:hover{ background: rgba(15,23,42,.04); }
    html.dark .tab-btn:hover{ background: rgba(255,255,255,.06); }

    .tab-btn.active{
      border-color: rgba(99,102,241,.55);
      background: rgba(99,102,241,.10);
      color: rgb(67 56 202);
      font-weight: 600;
    }
    html.dark .tab-btn.active{
      border-color: rgba(129,140,248,.55);
      background: rgba(129,140,248,.12);
      color: rgb(226 232 240);
    }

    /* Timetable table */
    .tt-table{
      width:100%;
      border-collapse:collapse;
      font-size:.78rem;
      overflow: hidden;
      border-radius: 1rem;
    }
    .tt-table th, .tt-table td{
      border: 1px solid rgba(226,232,240,.75);
      padding: .35rem .45rem;
      text-align:center;
    }
    html.dark .tt-table th, html.dark .tt-table td{
      border-color: rgba(51,65,85,.9);
    }
    .tt-table th{
      background: rgba(148,163,184,.14);
      font-weight: 700;
      font-size: .75rem;
    }
    html.dark .tt-table th{ background: rgba(15,23,42,.7); }

    .tt-slot-muted{ color: rgb(148 163 184); font-style: italic; }
    html.dark .tt-slot-muted{ color: rgb(100 116 139); }

    #unplacedContainer{ white-space: pre-line; }

    /* ===== Premium custom select (dropdown) ===== */
    .ep-native-select{
      position:absolute !important;
      opacity:0 !important;
      pointer-events:none !important;
      width:1px !important;
      height:1px !important;
      left:-9999px !important;
    }

    .ep-select{ position:relative; width:100%; overflow: visible; }
    .ep-select-btn{
      width:100%;
      min-height: var(--ep-field-h);
      border-radius: var(--ep-radius-lg);
      border: 1px solid rgba(226,232,240,.75);
      background: rgba(255,255,255,.65);
      padding: .62rem 1rem;
      font-size: 13px;
      line-height: 1.35;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.75rem;
      cursor:pointer;
      transition: background-color .15s ease, border-color .15s ease, box-shadow .15s ease, transform .08s ease;
    }
    .ep-select-btn:hover{ background: rgba(255,255,255,.78); }
    .ep-select-btn:active{ transform: translateY(1px); }
    .ep-select-btn:focus{
      outline:none;
      border-color: rgb(99,102,241);
      box-shadow: 0 0 0 3px rgba(99,102,241,.22);
    }

    html.dark .ep-select-btn{
      border-color: rgba(30,41,59,.7);
      background: rgba(255,255,255,.05);
      color: rgb(226,232,240);
    }

    .ep-select-sm .ep-select-btn{
      min-height: var(--ep-field-h-sm);
      padding: .48rem .85rem;
      font-size: 12.5px;
      line-height: 1.35;
      border-radius: var(--ep-radius-sm);
    }

    .ep-select-menu{
      position:absolute;
      inset-inline:0;
      top: calc(100% + .35rem);
      z-index: 9999;
      border-radius: 1rem;
      border: 1px solid rgba(226,232,240,.9);
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(10px);
      padding: .35rem;
      box-shadow: 0 18px 55px rgba(2,6,23,.18);
      display:none;
      max-height: 260px;
      overflow:auto;
    }
    html.dark .ep-select-menu{
      border-color: rgba(51,65,85,.9);
      background: rgba(2,6,23,.92);
      box-shadow: 0 18px 60px rgba(0,0,0,.45);
    }
    .ep-select.open .ep-select-menu{ display:block; }

    .ep-select-item{
      width:100%;
      border:0;
      background: transparent;
      color: inherit;
      border-radius: .85rem;
      padding: .55rem .75rem;
      font-size: 13px;
      text-align:left;
      cursor:pointer;
      transition: background-color .12s ease;
    }
    .ep-select-sm .ep-select-item{ font-size: 12.5px; padding: .5rem .7rem; }
    .ep-select-item:hover{ background: rgba(99,102,241,.10); }
    html.dark .ep-select-item:hover{ background: rgba(129,140,248,.14); }

    .ep-select-item[aria-selected="true"]{
      background: rgba(99,102,241,.16);
      font-weight: 600;
    }
    html.dark .ep-select-item[aria-selected="true"]{ background: rgba(129,140,248,.18); }

    /* =========================================================
       âœ… PARALLEL LAYOUT (Header ilÉ™ 1:1)
       - Reklam YOX: ep-frame = max-w-7xl + eyni padding
       - Reklam VAR: ep-frame geniÅŸlÉ™nir, shell 3 sÃ¼tun olur
    ========================================================= */
    .ep-frame{
      width: 100%;
      max-width: var(--ep-frame-max); /* header max-w-7xl */
      margin: 0 auto;
      padding-left: 16px;  /* px-4 */
      padding-right: 16px; /* px-4 */
      transition: max-width .22s ease, padding .22s ease;
    }
    @media (min-width: 640px){ /* sm:px-6 */
      .ep-frame{ padding-left: 24px; padding-right: 24px; }
    }
    @media (min-width: 1024px){ /* lg:px-8 */
      .ep-frame{ padding-left: 32px; padding-right: 32px; }
    }

    .ep-frame.has-ads{
      max-width: var(--ep-shell-max); /* reklam varsa geniÅŸlÉ™t */
    }

    .ep-shell{
      display:grid;
      grid-template-columns: 1fr;  /* default: reklam YOX */
      gap: 0;
      align-items:start;
      width:100%;
    }
    .ep-center{ min-width:0; }

    .ep-ad-slot{
      display:none;                 /* default: gÃ¶rÃ¼nmÉ™sin, yer saxlamasÄ±n */
      width: 100%;
      min-height: var(--ep-rail-min-h);
      align-items:flex-start;
      justify-content:center;
      overflow:hidden;

      position: sticky;
      top: 88px; /* header(64px) + boÅŸluq */
      height: fit-content;
    }
    .ep-ad-slot > div{ width:100%; max-width: 100%; }

    .ep-shell.has-left-ad,
    .ep-shell.has-right-ad{
      gap: var(--ep-rail-gap);
    }

    .ep-shell.has-left-ad .ep-ad-left{ display:flex; }
    .ep-shell.has-right-ad .ep-ad-right{ display:flex; }

    .ep-shell.has-left-ad.has-right-ad{
      grid-template-columns: minmax(0, var(--ep-rail-w)) minmax(0, var(--ep-center-max)) minmax(0, var(--ep-rail-w));
    }
    .ep-shell.has-left-ad:not(.has-right-ad){
      grid-template-columns: minmax(0, var(--ep-rail-w)) minmax(0, var(--ep-center-max)) 1fr;
    }
    .ep-shell.has-right-ad:not(.has-left-ad){
      grid-template-columns: 1fr minmax(0, var(--ep-center-max)) minmax(0, var(--ep-rail-w));
    }

    /* Laptop/telefon: relslÉ™r gizlÉ™nsin */
    @media (max-width: 1024px){
      .ep-frame.has-ads{ max-width: var(--ep-frame-max); } /* mobil-dÉ™ geniÅŸlÉ™nmÉ™ */
      .ep-shell{
        grid-template-columns: 1fr !important;
        gap: 0 !important;
      }
      .ep-ad-slot{ display:none !important; }
    }

    @media (max-width: 900px){
      table.config-table{ font-size: .76rem; }
      table.config-table th{ font-size: .68rem; }
      table.config-table input, table.config-table select{ font-size: 12px; }
      .t-days{ gap: 5px; }
    }
  </style>
</head>

<body class="min-h-screen pt-16 text-slate-900 dark:text-slate-100 bg-gradient-to-b from-slate-50 to-white dark:from-slate-950 dark:to-slate-900">

  <a href="#main"
     class="sr-only focus:not-sr-only focus:fixed focus:left-4 focus:top-4 focus:z-[100] focus:rounded-xl focus:bg-white focus:px-4 focus:py-2 focus:text-slate-900 focus:shadow">
    KontentÉ™ keÃ§
  </a>

  <div class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
    <div class="absolute -top-24 -right-24 h-72 w-72 rounded-full blur-3xl bg-gradient-to-tr from-indigo-200/60 to-emerald-200/60 dark:from-indigo-500/15 dark:to-emerald-500/10"></div>
    <div class="absolute -bottom-24 -left-24 h-72 w-72 rounded-full blur-3xl bg-gradient-to-tr from-amber-200/60 to-pink-200/60 dark:from-amber-500/10 dark:to-pink-500/10"></div>
  </div>

  <header class="fixed top-0 inset-x-0 z-50 border-b border-slate-200/70 dark:border-slate-800/70 bg-white/70 dark:bg-slate-950/60 backdrop-blur">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="h-16 flex items-center justify-between gap-3">
        <a href="/" class="flex items-center gap-3 rounded-2xl focus:outline-none focus:ring-2 focus:ring-indigo-400">
          <img src="assets/ep-favicon-light.svg" alt="EduPlan" class="h-9 w-9 dark:hidden" width="36" height="36" />
          <img src="assets/ep-favicon-dark.svg" alt="" aria-hidden="true" class="h-9 w-9 hidden dark:block" width="36" height="36" />
          <span class="font-semibold tracking-tight">EduPlan AZ</span>
        </a>

        <button
          id="theme-toggle"
          type="button"
          class="inline-flex items-center justify-center rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-slate-900/40 p-2 hover:bg-slate-200/70 dark:hover:bg-slate-900/60 transition focus:outline-none focus:ring-2 focus:ring-indigo-400"
          aria-label="Tema dÉ™yiÅŸdir"
          aria-pressed="false"
        >
          <svg class="h-5 w-5 dark:hidden" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z" stroke="currentColor" stroke-width="2"/>
            <path d="M12 2v2M12 20v2M4 12H2M22 12h-2M5 5l-1.5-1.5M20.5 20.5 19 19M19 5l1.5-1.5M3.5 20.5 5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <svg class="h-5 w-5 hidden dark:block" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M21 13.2A7.5 7.5 0 0 1 10.8 3 6.9 6.9 0 1 0 21 13.2Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <main id="main" class="pt-4 pb-0">
    <!-- âœ… ReklamsÄ±z halda header ilÉ™ paralel -->
    <div class="ep-frame" id="ep-frame">
      <div class="ep-shell" id="ep-shell">

        <!-- SOL reklam slotu -->
        <aside class="ep-ad-slot ep-ad-left no-print" data-ad-slot="left" aria-label="Reklam (sol)">
          <!-- SOL reklam kodu bura -->
        </aside>

        <div class="ep-center">
          <section class="py-6 sm:py-8">
            <h1 class="text-2xl sm:text-3xl lg:text-4xl font-bold tracking-tight">DÉ™rs cÉ™dvÉ™li hazÄ±rlayÄ±cÄ±</h1>
            <p class="mt-2 text-slate-600 dark:text-slate-300">
              Orta mÉ™ktÉ™blÉ™r Ã¼Ã§Ã¼n dÉ™rs cÉ™dvÉ™li: mÃ¼É™llim, sinif vÉ™ fÉ™nn mÉ™lumatlarÄ±nÄ± daxil edin, sistem tipik mÉ™hdudiyyÉ™tlÉ™rlÉ™ avtomatik cÉ™dvÉ™l qursun.
            </p>
          </section>

          <section class="rounded-3xl border border-slate-200/70 dark:border-slate-800/70 bg-white/70 dark:bg-white/5 backdrop-blur shadow-sm">
            <div class="px-6 py-4 border-b border-slate-200/70 dark:border-slate-800/70 flex items-center justify-between gap-4">
              <div class="font-semibold">ğŸ§© MÉ™ktÉ™b konfiqurasiyasÄ± vÉ™ hazÄ±rlayÄ±cÄ±</div>
            </div>

            <div class="p-6 space-y-4">

              <!-- 1) MÉ™ktÉ™b parametrlÉ™ri -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4">
                <div class="section-title mb-2">MÉ™ktÉ™b parametrlÉ™ri</div>

                <div class="grid grid-cols-2 gap-3 text-sm">
                  <div>
                    <label class="block text-xs mb-1 text-slate-600 dark:text-slate-300">HÉ™ftÉ™lik iÅŸ gÃ¼nÃ¼</label>
                    <select id="daysCount">
                      <option value="5">5 gÃ¼n (B.eâ€“C.u)</option>
                      <option value="6">6 gÃ¼n (B.eâ€“Å)</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-xs mb-1 text-slate-600 dark:text-slate-300">GÃ¼ndÉ™ dÉ™rs saatÄ± (max)</label>
                    <input id="lessonsPerDay" type="number" min="1" max="8" value="7" />
                  </div>
                </div>

                <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-slate-600 dark:text-slate-300">
                  <label class="inline-flex items-start gap-2">
                    <input id="optHeavyAvoidEdges" type="checkbox" class="mt-0.5" checked />
                    <span>AÄŸÄ±r fÉ™nlÉ™r mÃ¼mkÃ¼n qÉ™dÉ™r 1-ci vÉ™ sonuncu saatda olmasÄ±n</span>
                  </label>
                  <label class="inline-flex items-start gap-2">
                    <input id="optLimitSameSubject" type="checkbox" class="mt-0.5" checked />
                    <span>Eyni gÃ¼ndÉ™ eyni fÉ™nn 2 dÉ™fÉ™dÉ™n Ã§ox bir sinifdÉ™ tÉ™krarlanmasÄ±n</span>
                  </label>
                </div>

                <div class="mt-3 text-[11px] text-slate-500 dark:text-slate-400">
                  Ä°btidai Ã¼Ã§Ã¼n gÃ¼ndÉ™ 6, É™sas Ã¼Ã§Ã¼n 7, yuxarÄ± Ã¼Ã§Ã¼n 8 dÉ™rs limiti standart kimi tÉ™tbiq olunur
                  (sinif cÉ™dvÉ™lindÉ™ ayrÄ±ca dÉ™yiÅŸmÉ™k mÃ¼mkÃ¼ndÃ¼r).
                </div>
              </div>

              <!-- 2) MÃ¼É™llimlÉ™r -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4">
                <div class="flex items-center justify-between mb-2">
                  <div class="section-title">MÃ¼É™llimlÉ™r</div>
                  <button type="button" id="btnAddTeacher"
                          class="no-print inline-flex items-center gap-1 rounded-xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 px-3 py-2 text-xs font-semibold hover:bg-slate-200/70 dark:hover:bg-slate-900/60 transition">
                    â• ÆlavÉ™ et
                  </button>
                </div>

                <div class="text-[11px] text-slate-500 dark:text-slate-400 mb-3">
                  HÉ™r mÃ¼É™llim Ã¼Ã§Ã¼n hÉ™ftÉ™lik vÉ™ gÃ¼ndÉ™lik maksimum saat, gÉ™lmÉ™ gÃ¼nlÉ™ri vÉ™ 1-ci / sonuncu saatdan qaÃ§maq istÉ™yi.
                </div>

                <table class="config-table" id="teacherTable">
                  <thead>
                    <tr>
                      <th>Ad, soyad</th>
                      <th>Kod</th>
                      <th>HÉ™ftÉ™lik<span class="block">max</span></th>
                      <th>GÃ¼ndÉ™<span class="block">max</span></th>
                      <th>1-ci saatÄ±<span class="block">sevmir</span></th>
                      <th>Sonuncu saatÄ±<span class="block">sevmir</span></th>
                      <th>GÉ™lmÉ™ gÃ¼nlÉ™ri</th>
                      <th class="no-print"></th>
                    </tr>
                  </thead>
                  <tbody id="teacherTbody"></tbody>
                </table>
              </div>

              <!-- 3) SiniflÉ™r -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4">
                <div class="flex items-center justify-between mb-2">
                  <div class="section-title">SiniflÉ™r</div>
                  <button type="button" id="btnAddClass"
                          class="no-print inline-flex items-center gap-1 rounded-xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 px-3 py-2 text-xs font-semibold hover:bg-slate-200/70 dark:hover:bg-slate-900/60 transition">
                    â• ÆlavÉ™ et
                  </button>
                </div>

                <div class="text-[11px] text-slate-500 dark:text-slate-400 mb-3">
                  SÉ™viyyÉ™: 1â€“4 ibtidai, 5â€“8 É™sas, 9â€“11 yuxarÄ±. NÃ¶vbÉ™ sadÉ™cÉ™ informasiya Ã¼Ã§Ã¼ndÃ¼r.
                </div>

                <table class="config-table" id="classTable">
                  <thead>
                    <tr>
                      <th>Sinif</th>
                      <th>SÉ™viyyÉ™</th>
                      <th>NÃ¶vbÉ™</th>
                      <th>GÃ¼ndÉ™ max dÉ™rs</th>
                      <th class="no-print"></th>
                    </tr>
                  </thead>
                  <tbody id="classTbody"></tbody>
                </table>
              </div>

              <!-- 4) FÉ™nn / dÉ™rs saatlarÄ± -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4">
                <div class="flex items-center justify-between mb-2">
                  <div class="section-title">FÉ™nn / dÉ™rs saatlarÄ±</div>
                  <button type="button" id="btnAddLesson"
                          class="no-print inline-flex items-center gap-1 rounded-xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 px-3 py-2 text-xs font-semibold hover:bg-slate-200/70 dark:hover:bg-slate-900/60 transition">
                    â• ÆlavÉ™ et
                  </button>
                </div>

                <div class="text-[11px] text-slate-500 dark:text-slate-400 mb-3">
                  HÉ™r sÉ™tir: sinif + fÉ™nn + mÃ¼É™llim + hÉ™ftÉ™lik saat. â€œQoÅŸaâ€ seÃ§sÉ™niz, imkan daxilindÉ™ ardÄ±cÄ±l yerlÉ™ÅŸdirÉ™cÉ™k.
                </div>

                <table class="config-table" id="lessonTable">
                  <thead>
                    <tr>
                      <th>Sinif</th>
                      <th>FÉ™nn</th>
                      <th>MÃ¼É™llim kodu/adÄ±</th>
                      <th>HÉ™ftÉ™lik saat</th>
                      <th>AÄŸÄ±r?</th>
                      <th>QoÅŸa?</th>
                      <th class="no-print"></th>
                    </tr>
                  </thead>
                  <tbody id="lessonTbody"></tbody>
                </table>
              </div>

              <!-- 5) HazÄ±rlayÄ±cÄ± -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4 no-print">
                <div class="section-title mb-2">HazÄ±rlayÄ±cÄ±</div>

                <div class="space-y-1.5 text-xs text-slate-600 dark:text-slate-300 mb-4">
                  <p>1) MÃ¼É™llim, sinif vÉ™ fÉ™nn mÉ™lumatlarÄ±nÄ± doldurun.</p>
                  <p>2) â€œCÉ™dvÉ™li qurâ€ dÃ¼ymÉ™sini sÄ±xÄ±n â€” sistem tam hÉ™ll tapana qÉ™dÉ™r fÉ™rqli kombinasiyalar sÄ±nayacaq.</p>
                  <p class="text-[11px] text-slate-500 dark:text-slate-400">
                    Proses zamanÄ± dÃ¼ymÉ™ â€œğŸ›‘ DayandÄ±râ€ olur â€” istÉ™sÉ™niz axtarÄ±ÅŸÄ± istÉ™nilÉ™n vaxt dayandÄ±ra bilÉ™rsiniz.
                  </p>
                </div>

                <div class="flex flex-wrap gap-2">
                  <button id="btnGenerate"
                          class="ep-btn-primary inline-flex items-center justify-center rounded-2xl px-4 py-3 text-sm font-semibold text-white shadow-sm hover:brightness-110 transition">
                    âš™ï¸ CÉ™dvÉ™li qur
                  </button>

                  <button id="btnResetAll"
                          class="inline-flex items-center justify-center rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 px-4 py-3 text-xs font-semibold hover:bg-slate-200/70 dark:hover:bg-slate-900/60 transition">
                    ğŸ§¹ HamÄ±sÄ±nÄ± tÉ™mizlÉ™
                  </button>
                </div>

                <div id="globalError" class="mt-3 text-xs text-rose-500 hidden"></div>
                <div id="globalInfo" class="mt-2 text-[11px] text-slate-500 dark:text-slate-400"></div>
              </div>

              <!-- 6) NÉ™ticÉ™ -->
              <div class="rounded-2xl border border-slate-200/70 dark:border-slate-800/70 bg-white/60 dark:bg-white/5 p-4 min-h-[260px]" id="resultCard">
                <div class="flex items-center justify-between mb-3">
                  <div class="section-title">NÉ™ticÉ™</div>
                  <div id="resultStats" class="text-[11px] text-slate-500 dark:text-slate-400"></div>
                </div>

                <div id="classTabs" class="flex flex-wrap gap-1 mb-3 text-xs no-print"></div>

                <div id="timetableContainer" class="overflow-x-auto text-xs">
                  <div class="text-[12px] text-slate-500 dark:text-slate-400">
                    HÉ™lÉ™ cÉ™dvÉ™l qurulmayÄ±b. MÉ™lumatlarÄ± daxil etdikdÉ™n sonra <strong>â€œCÉ™dvÉ™li qurâ€</strong> dÃ¼ymÉ™sini sÄ±xÄ±n.
                  </div>
                </div>

                <div id="unplacedContainer" class="mt-3 text-[11px] text-amber-600 dark:text-amber-400 hidden"></div>
                <div id="softWarnings" class="mt-2 text-[11px] text-slate-500 dark:text-slate-400"></div>
              </div>

            </div>
          </section>

          <section class="mt-10 rounded-3xl border border-slate-200/70 dark:border-slate-800/70 bg-white/70 dark:bg-white/5 backdrop-blur p-6 sm:p-10 shadow-sm">
            <h2 class="text-2xl sm:text-3xl font-semibold">MÉ™lumat</h2>

            <div class="mt-5 space-y-6 text-base leading-7 text-slate-700 dark:text-slate-200">
              <p>
                Bu sÉ™hifÉ™dÉ™ki <strong>â€œğŸ§© MÉ™ktÉ™b konfiqurasiyasÄ± vÉ™ hazÄ±rlayÄ±cÄ±â€</strong> bloku
                dÉ™rs cÉ™dvÉ™lini <strong>tamamilÉ™ brauzerdÉ™</strong> qurmaq Ã¼Ã§Ã¼n hazÄ±rlanÄ±b:
                siz mÃ¼É™llim/sinif/fÉ™nn mÉ™lumatlarÄ±nÄ± daxil edirsiniz, sistem isÉ™ konfliktlÉ™ri minimuma endirÉ™rÉ™k
                cÉ™dvÉ™li avtomatik yÄ±ÄŸmaÄŸa Ã§alÄ±ÅŸÄ±r.
              </p>

              <div class="rounded-2xl border border-slate-200/60 dark:border-slate-800/60 bg-white/60 dark:bg-white/5 p-4">
                <div class="font-semibold text-slate-900 dark:text-slate-100">Ä°ÅŸ prinsipi (qÄ±sa axÄ±n)</div>
                <ol class="mt-2 list-decimal pl-6 space-y-1">
                  <li><strong>MÉ™ktÉ™b parametrlÉ™ri</strong> â€” hÉ™ftÉ™ gÃ¼nÃ¼ sayÄ± vÉ™ gÃ¼ndÉ™ maksimum saatÄ± seÃ§in.</li>
                  <li><strong>MÃ¼É™llimlÉ™r</strong> â€” hÉ™r mÃ¼É™llimin limitlÉ™rini vÉ™ gÉ™lmÉ™ gÃ¼nlÉ™rini yazÄ±n.</li>
                  <li><strong>SiniflÉ™r</strong> â€” sinif siyahÄ±sÄ±nÄ± (sÉ™viyyÉ™, nÃ¶vbÉ™, gÃ¼ndÉ™ limit) daxil edin.</li>
                  <li><strong>FÉ™nn / dÉ™rs saatlarÄ±</strong> â€” â€œsinif + fÉ™nn + mÃ¼É™llim + hÉ™ftÉ™lik saatâ€ sÉ™tirlÉ™rini É™lavÉ™ edin.</li>
                  <li><strong>âš™ï¸ CÉ™dvÉ™li qur</strong> â€” sistem <strong>tam hÉ™ll tapÄ±lanadÉ™k</strong> fÉ™rqli kombinasiyalar sÄ±nayÄ±r.</li>
                  <li><strong>NÉ™ticÉ™</strong> â€” sinif tablarÄ±nÄ± dÉ™yiÅŸÉ™rÉ™k cÉ™dvÉ™li yoxlayÄ±n, lazÄ±m olsa parametrlÉ™ri dÃ¼zÉ™ldin vÉ™ yenidÉ™n qurun.</li>
                </ol>

                <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">
                  Proses zamanÄ± ekranda <strong>cÉ™hd sayÄ±</strong> vÉ™ <strong>É™n yaxÅŸÄ± tapÄ±lan nÉ™ticÉ™</strong> (faizlÉ™) gÃ¶stÉ™rilir.
                  Ä°stÉ™sÉ™niz <strong>ğŸ›‘ DayandÄ±r</strong> dÃ¼ymÉ™si ilÉ™ axtarÄ±ÅŸÄ± dayandÄ±rÄ±b hÉ™min â€œÉ™n yaxÅŸÄ±â€ nÉ™ticÉ™yÉ™ baxa bilÉ™rsiniz.
                </p>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">1) MÉ™ktÉ™b parametrlÉ™ri nÉ™ edir?</h3>
                <ul class="mt-2 list-disc pl-6 space-y-1">
                  <li>
                    <strong>HÉ™ftÉ™lik iÅŸ gÃ¼nÃ¼ (5/6)</strong> cÉ™dvÉ™lin sÃ¼tun sayÄ±nÄ± mÃ¼É™yyÉ™n edir:
                    5 gÃ¼n seÃ§É™ndÉ™ <em>ÅÉ™nbÉ™</em> (Å) gizlÉ™nir vÉ™ mÃ¼É™llimlÉ™rin â€œÅâ€ gÃ¼nÃ¼ avtomatik deaktiv edilir.
                  </li>
                  <li>
                    <strong>GÃ¼ndÉ™ dÉ™rs saatÄ± (max)</strong> hÉ™r sinif Ã¼Ã§Ã¼n matrisin (gÃ¼n Ã— saat) Ã¶lÃ§Ã¼sÃ¼nÃ¼ tÉ™yin edir.
                    MÉ™sÉ™lÉ™n 7 seÃ§sÉ™niz, hÉ™r gÃ¼n 1â€“7 saat aralÄ±ÄŸÄ± yaranÄ±r.
                  </li>
                  <li>
                    <strong>AÄŸÄ±r fÉ™nlÉ™r 1-ci/sonuncu saatda olmasÄ±n</strong> â€” bu seÃ§im aktivdirsÉ™,
                    â€œAÄŸÄ±r?â€ iÅŸarÉ™lÉ™diyiniz dÉ™rslÉ™r É™vvÉ™lcÉ™ <strong>1-ci vÉ™ sonuncu</strong> saata qoyulmur (yumÅŸaq qayda).
                  </li>
                  <li>
                    <strong>Eyni gÃ¼ndÉ™ eyni fÉ™nn 2 dÉ™fÉ™dÉ™n Ã§ox tÉ™krarlanmasÄ±n</strong> â€” aktivdirsÉ™,
                    bir sinifdÉ™ eyni fÉ™nnin bir gÃ¼ndÉ™ toplamÄ± <strong>2 saatdan Ã§ox</strong> olmamaÄŸa Ã§alÄ±ÅŸÄ±lÄ±r (yumÅŸaq qayda).
                  </li>
                </ul>

                <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">
                  Qeyd: Bu iki seÃ§im <strong>yumÅŸaq mÉ™hdudiyyÉ™t</strong> kimidir â€”
                  sistem É™vvÉ™lcÉ™ onlarÄ± qorumaÄŸa Ã§alÄ±ÅŸÄ±r, yer tapÄ±lmasa sonradan yumÅŸalda bilÉ™r.
                </p>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">2) MÃ¼É™llimlÉ™r bÃ¶lmÉ™si necÉ™ istifadÉ™ olunur?</h3>

                <ul class="mt-2 list-disc pl-6 space-y-1">
                  <li>
                    <strong>Ad, soyad</strong> vÉ™ <strong>Kod</strong>:
                    â€œFÉ™nn / dÉ™rs saatlarÄ±â€ bÃ¶lmÉ™sindÉ™ mÃ¼É™llimi tapmaq Ã¼Ã§Ã¼n sistem mÃ¼É™llimi <strong>kodla vÉ™ ya adla</strong> uyÄŸunlaÅŸdÄ±rÄ±r.
                    Praktik Ã¼sul: hÉ™r mÃ¼É™llimÉ™ qÄ±sa kod verin (mÉ™s: <code class="px-1 rounded bg-slate-100/80 dark:bg-white/10">Ä°SF</code>).
                  </li>
                  <li>
                    <strong>HÉ™ftÉ™lik max</strong> vÉ™ <strong>GÃ¼ndÉ™ max</strong>: mÃ¼É™llimin hÉ™ftÉ™lik/gÃ¼ndÉ™lik dÉ™rs limitidir.
                    <strong>0</strong> yazÄ±lsa (vÉ™ ya boÅŸ qalsa) sistem bunu â€œlimitsizâ€ kimi qÉ™bul edir.
                  </li>
                  <li>
                    <strong>1-ci saatÄ± sevmir</strong> / <strong>Sonuncu saatÄ± sevmir</strong>:
                    sistem É™vvÉ™lcÉ™ bu istÉ™klÉ™ri qoruyaraq yerlÉ™ÅŸdirmÉ™yÉ™ Ã§alÄ±ÅŸÄ±r, alÄ±nmasa yumÅŸalda bilÉ™r (yumÅŸaq qayda).
                  </li>
                  <li>
                    <strong>GÉ™lmÉ™ gÃ¼nlÉ™ri</strong>:
                    mÃ¼É™llimin dÉ™rsinin hansÄ± gÃ¼nlÉ™rdÉ™ ola bilÉ™cÉ™yini gÃ¶stÉ™rir. HeÃ§ nÉ™ seÃ§mÉ™sÉ™niz,
                    sistem <strong>hamÄ± gÃ¼nlÉ™r</strong> kimi qÉ™bul edir.
                    Vacib: â€œgÉ™lmÉ™ gÃ¼nlÉ™riâ€ <strong>sÉ™rt mÉ™hdudiyyÉ™tdir</strong> â€” pozulmur.
                  </li>
                </ul>

                <div class="mt-3 rounded-xl border border-amber-200/70 dark:border-amber-500/30 bg-amber-50/70 dark:bg-amber-500/10 p-3 text-sm">
                  <div class="font-semibold text-amber-900 dark:text-amber-200">DiqqÉ™t (uyÄŸunlaÅŸdÄ±rma)</div>
                  <p class="mt-1">
                    â€œFÉ™nn / dÉ™rs saatlarÄ±â€ bÃ¶lmÉ™sindÉ™ mÃ¼É™llimi <strong>kod vÉ™ ya ad</strong> ilÉ™ yazanda,
                    bu dÉ™yÉ™r mÃ¼É™llim cÉ™dvÉ™lindÉ™ki kod/ad ilÉ™ <strong>eyni yazÄ±lÄ±ÅŸda</strong> olmalÄ±dÄ±r
                    (sistem yalnÄ±z boÅŸluqlarÄ± kÉ™sir).
                    MÉ™sÉ™lÉ™n <code class="px-1 rounded bg-white/60 dark:bg-white/10">FÄ°R</code> ilÉ™
                    <code class="px-1 rounded bg-white/60 dark:bg-white/10">fir</code> fÉ™rqli sayÄ±lÄ±r.
                  </p>
                </div>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">3) SiniflÉ™r bÃ¶lmÉ™si necÉ™ iÅŸlÉ™yir?</h3>

                <ul class="mt-2 list-disc pl-6 space-y-1">
                  <li>
                    <strong>Sinif</strong> (mÉ™s: 5A) â€” â€œFÉ™nn / dÉ™rs saatlarÄ±â€ sÉ™tirlÉ™rindÉ™ dÉ™ eyni adla yazÄ±lmalÄ±dÄ±r.
                  </li>
                  <li>
                    <strong>SÉ™viyyÉ™</strong> gÃ¼ndÉ™ standart limiti tÉ™sir edir:
                    <strong>Ä°btidai â†’ 6</strong>, <strong>Æsas â†’ 7</strong>, <strong>YuxarÄ± â†’ 8</strong>.
                    ÆgÉ™r â€œGÃ¼ndÉ™ max dÉ™rsâ€ sahÉ™sinÉ™ rÉ™qÉ™m yazsanÄ±z, hÉ™min sinif Ã¼Ã§Ã¼n bu limit Ã¼stÉ™lÉ™nir.
                  </li>
                  <li>
                    <strong>NÃ¶vbÉ™</strong> (SÉ™hÉ™r/GÃ¼norta) hazÄ±rda <strong>informasiya Ã¼Ã§Ã¼ndÃ¼r</strong> â€”
                    alqoritm nÃ¶vbÉ™yÉ™ gÃ¶rÉ™ ayrÄ±ca mÉ™hdudiyyÉ™t tÉ™tbiq etmir.
                  </li>
                </ul>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">4) FÉ™nn / dÉ™rs saatlarÄ±: É™n vacib hissÉ™</h3>

                <p class="mt-2">
                  Bu cÉ™dvÉ™ldÉ™ki hÉ™r sÉ™tir bir â€œtÉ™dris tapÅŸÄ±rÄ±ÄŸÄ±dÄ±râ€:
                  <strong>hansÄ± sinifÉ™</strong>, <strong>hansÄ± fÉ™nn</strong>, <strong>hansÄ± mÃ¼É™llim</strong> vÉ™
                  <strong>hÉ™ftÉ™dÉ™ neÃ§É™ saat</strong>.
                </p>

                <ul class="mt-3 list-disc pl-6 space-y-1">
                  <li>
                    <strong>HÉ™ftÉ™lik saat</strong> daxil etdikdÉ™ sistem bunu â€œbloklaraâ€ parÃ§alayÄ±r vÉ™ yerlÉ™ÅŸdirir.
                  </li>
                  <li>
                    <strong>QoÅŸa?</strong> seÃ§ilibsÉ™ vÉ™ saat sayÄ± â‰¥ 2-dirsÉ™:
                    sistem hÉ™min dÉ™rsi <strong>2 saatlÄ±q bloklar</strong> kimi yerlÉ™ÅŸdirmÉ™yÉ™ Ã§alÄ±ÅŸÄ±r.
                    MÉ™sÉ™lÉ™n 5 saat â†’ 2+2+1 bloklara bÃ¶lÃ¼nÃ¼r.
                  </li>
                  <li>
                    <strong>AÄŸÄ±r?</strong> seÃ§ilibsÉ™:
                    â€œAÄŸÄ±r fÉ™nlÉ™r 1-ci/sonuncu saatda olmasÄ±nâ€ parametri aktiv olanda
                    sistem É™vvÉ™lcÉ™ aÄŸÄ±r fÉ™nni 1-ci/sonuncu saata salmamaÄŸa Ã§alÄ±ÅŸÄ±r.
                  </li>
                </ul>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">5) â€œCÉ™dvÉ™li qurâ€ dÃ¼ymÉ™si arxada nÉ™ edir?</h3>

                <ul class="mt-2 list-disc pl-6 space-y-1">
                  <li>
                    Sistem â€œdÉ™rs bloklarÄ±nÄ±â€ mÃ¼xtÉ™lif ardÄ±cÄ±llÄ±qlarda vÉ™ slot kombinasiyalarÄ±nda yerlÉ™ÅŸdirmÉ™yÉ™ Ã§alÄ±ÅŸÄ±r.
                  </li>
                  <li>
                    <strong>SÉ™rt mÉ™hdudiyyÉ™tlÉ™r</strong> (mÃ¼É™llim konfliktlÉ™ri, gÉ™lmÉ™ gÃ¼nlÉ™ri, limitlÉ™r, sinif tutumu) pozulmur.
                  </li>
                  <li>
                    <strong>YumÅŸaq mÉ™hdudiyyÉ™tlÉ™r</strong> (aÄŸÄ±r fÉ™nn kÉ™nar saatlar, 1-ci/sonuncu saat istÉ™klÉ™ri, eyni fÉ™nnin gÃ¼ndÉ™ 2-dÉ™n Ã§ox olmamasÄ±)
                    É™vvÉ™lcÉ™ qorunur, yer tapÄ±lmasa yumÅŸaldÄ±la bilÉ™r.
                  </li>
                  <li>
                    Tam hÉ™ll tapÄ±lanadÉ™k axtarÄ±ÅŸ davam edir. Konfiqurasiya hÉ™qiqÉ™tÉ™n mÃ¼mkÃ¼nsÃ¼zdÃ¼rsÉ™ axtarÄ±ÅŸ da uzana bilÉ™r â€”
                    bu halda <strong>ğŸ›‘ DayandÄ±r</strong> dÃ¼ymÉ™si ilÉ™ prosesi dayandÄ±rÄ±b É™n yaxÅŸÄ± tapÄ±lmÄ±ÅŸ nÉ™ticÉ™ni gÃ¶rÉ™ bilÉ™rsiniz.
                  </li>
                </ul>
              </div>

              <div>
                <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">Tez-tez rast gÉ™linÉ™n problemlÉ™r vÉ™ hÉ™ll yollarÄ±</h3>
                <ul class="mt-2 list-disc pl-6 space-y-1">
                  <li>
                    <strong>â€œSinif/mÃ¼É™llim tapÄ±lmadÄ±â€ xÉ™tasÄ±</strong> â†’
                    sinif adlarÄ±nÄ± vÉ™ mÃ¼É™llim kod/adÄ±nÄ± bÃ¼tÃ¼n yerlÉ™rdÉ™ eyni yazÄ±n.
                  </li>
                  <li>
                    <strong>Ã‡ox â€œYerlÉ™ÅŸdirilmÉ™yÉ™nlÉ™râ€ Ã§Ä±xÄ±r</strong> â†’
                    sinif/mÃ¼É™llim limitlÉ™rini yoxlayÄ±n, sinif tutumunu artÄ±rÄ±n (gÃ¼ndÉ™ max), mÃ¼É™llim gÉ™lmÉ™ gÃ¼nlÉ™rini geniÅŸlÉ™ndirin.
                  </li>
                  <li>
                    <strong>AxtarÄ±ÅŸ Ã§ox uzanÄ±r</strong> â†’
                    Ã§ox vaxt bu ya konfiqurasiyanÄ±n mÃ¼mkÃ¼nsÃ¼z olmasÄ±na, ya da limitlÉ™rin hÉ™ddÉ™n artÄ±q sÉ™rt olmasÄ±na iÅŸarÉ™ edir.
                  </li>
                </ul>
              </div>

              <p class="text-sm text-slate-600 dark:text-slate-300">
                Qeyd: Bu alqoritm brauzerdÉ™ iÅŸlÉ™yir vÉ™ â€œtam hÉ™ll tapÄ±lanadÉ™kâ€ axtarÄ±ÅŸ aparÄ±r. Real mÉ™ktÉ™b cÉ™dvÉ™llÉ™rindÉ™ É™n stabil nÉ™ticÉ™ Ã¼Ã§Ã¼n
                kod/ad uyÄŸunluÄŸunu qorumaq vÉ™ limitlÉ™ri realist qurmaq É™n vacibdir.
              </p>
            </div>
          </section>
        </div>

        <!-- SAÄ reklam slotu -->
        <aside class="ep-ad-slot ep-ad-right no-print" data-ad-slot="right" aria-label="Reklam (saÄŸ)">
          <!-- SAÄ reklam kodu bura -->
        </aside>

      </div>
    </div>
  </main>

  <footer class="mt-10 border-t border-slate-200/70 dark:border-slate-800/70">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8 flex flex-col sm:flex-row gap-4 items-center justify-between text-sm text-slate-600 dark:text-slate-300">
      <div>
        Â© <span id="year"></span> <span class="font-semibold text-slate-900 dark:text-slate-100">EduPlan AZ</span> Â· BÃ¼tÃ¼n hÃ¼quqlar qorunur
      </div>

      <nav class="flex flex-wrap items-center justify-center gap-x-5 gap-y-2">
        <a class="hover:underline underline-offset-4" href="/about.html">HaqqÄ±mÄ±zda</a>
        <a class="hover:underline underline-offset-4" href="/contact.html">ÆlaqÉ™</a>
        <a class="hover:underline underline-offset-4" href="/terms.html">ÅÉ™rtlÉ™r</a>
        <a class="hover:underline underline-offset-4" href="/privacy.html">MÉ™xfilik</a>
      </nav>
    </div>
  </footer>

  <script>
    (function () {
      const yearEl = document.getElementById('year');
      if (yearEl) yearEl.textContent = new Date().getFullYear();

      const btn = document.getElementById('theme-toggle');
      const meta = document.getElementById('theme-color');
      const mq = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');

      const hasUserPref = () => {
        try { return !!localStorage.getItem('theme'); } catch (e) { return false; }
      };

      const getTheme = () => (document.documentElement.classList.contains('dark') ? 'dark' : 'light');

      function applyTheme(theme, persist) {
        const isDark = theme === 'dark';
        document.documentElement.classList.toggle('dark', isDark);
        document.documentElement.dataset.theme = theme;

        if (btn) btn.setAttribute('aria-pressed', isDark ? 'true' : 'false');
        if (meta) meta.setAttribute('content', isDark ? '#0b1220' : '#ffffff');

        if (persist) {
          try { localStorage.setItem('theme', theme); } catch (e) {}
        }
      }

      applyTheme(getTheme(), false);

      btn && btn.addEventListener('click', function () {
        const next = (getTheme() === 'dark') ? 'light' : 'dark';
        applyTheme(next, true);
      });

      const onSystemChange = function (e) {
        if (!hasUserPref()) applyTheme(e.matches ? 'dark' : 'light', false);
      };

      if (mq) {
        if (mq.addEventListener) mq.addEventListener('change', onSystemChange);
        else if (mq.addListener) mq.addListener(onSystemChange);
      }
    })();
  </script>

  <!-- âœ… Reklam gÉ™lsÉ™: avtomatik 3 sÃ¼tun + frame geniÅŸlÉ™nir (paralel qalÄ±r) -->
  <script>
    (function () {
      const frame = document.getElementById('ep-frame');
      const shell = document.getElementById('ep-shell');
      if (!frame || !shell) return;

      const left  = shell.querySelector('[data-ad-slot="left"]');
      const right = shell.querySelector('[data-ad-slot="right"]');

      const hasContent = (el) => {
        if (!el) return false;
        return Array.from(el.childNodes).some(n => {
          if (n.nodeType === Node.ELEMENT_NODE) return true;
          if (n.nodeType === Node.TEXT_NODE) return n.textContent.trim().length > 0;
          return false;
        });
      };

      const update = () => {
        const hasLeft = hasContent(left);
        const hasRight = hasContent(right);

        shell.classList.toggle('has-left-ad', hasLeft);
        shell.classList.toggle('has-right-ad', hasRight);

        const hasAds = hasLeft || hasRight;
        frame.classList.toggle('has-ads', hasAds);
      };

      update();

      const obs = new MutationObserver(update);
      if (left)  obs.observe(left,  { childList: true, subtree: true });
      if (right) obs.observe(right, { childList: true, subtree: true });
    })();
  </script>

  <!-- Timetable logic -->
  <script>
    (function () {
      const teacherTbody = document.getElementById('teacherTbody');
      const classTbody = document.getElementById('classTbody');
      const lessonTbody = document.getElementById('lessonTbody');

      const btnAddTeacher = document.getElementById('btnAddTeacher');
      const btnAddClass = document.getElementById('btnAddClass');
      const btnAddLesson = document.getElementById('btnAddLesson');

      const btnGenerate = document.getElementById('btnGenerate');
      const btnResetAll = document.getElementById('btnResetAll');

      const globalError = document.getElementById('globalError');
      const globalInfo  = document.getElementById('globalInfo');

      const resultStats = document.getElementById('resultStats');
      const timetableContainer = document.getElementById('timetableContainer');
      const unplacedContainer = document.getElementById('unplacedContainer');
      const softWarnings = document.getElementById('softWarnings');
      const classTabs = document.getElementById('classTabs');

      const daysCountSelect = document.getElementById('daysCount');

      const DAYS_LABELS_5 = ['B.e','Ã‡.a','Ã‡','C','C.u'];
      const DAYS_LABELS_6 = ['B.e','Ã‡.a','Ã‡','C','C.u','Å'];
      const DAY_LABELS_FULL = ['B.e','Ã‡.a','Ã‡','C','C.u','Å'];

      const __epSelectInstances = new Set();

      // ===== Solve state (sonsuz cÉ™hd) =====
      const GENERATE_LABEL = 'âš™ï¸ CÉ™dvÉ™li qur';
      const STOP_LABEL = 'ğŸ›‘ DayandÄ±r';

      let __solverRunning = false;
      let __stopRequested = false;
      let __runId = 0;

      function makePrettySelect(selectEl, opts = {}) {
        if (!selectEl || selectEl.dataset.epPrettySelect === '1') return;

        const size = opts.size === 'sm' ? 'sm' : 'md';

        const wrap = document.createElement('div');
        wrap.className = 'ep-select' + (size === 'sm' ? ' ep-select-sm' : '');

        selectEl.parentNode.insertBefore(wrap, selectEl);
        wrap.appendChild(selectEl);

        selectEl.classList.add('ep-native-select');
        selectEl.dataset.epPrettySelect = '1';

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'ep-select-btn';
        btn.setAttribute('aria-haspopup', 'listbox');
        btn.setAttribute('aria-expanded', 'false');

        const menu = document.createElement('div');
        menu.className = 'ep-select-menu';
        menu.setAttribute('role', 'listbox');

        wrap.appendChild(btn);
        wrap.appendChild(menu);

        function close() {
          wrap.classList.remove('open');
          btn.setAttribute('aria-expanded', 'false');
        }
        function open() {
          __epSelectInstances.forEach(inst => { if (inst !== api) inst.close(); });
          wrap.classList.add('open');
          btn.setAttribute('aria-expanded', 'true');
        }
        function toggle() { wrap.classList.contains('open') ? close() : open(); }

        function render() {
          const selected = selectEl.options[selectEl.selectedIndex];
          const label = selected ? selected.textContent : '';

          btn.innerHTML = `
            <span style="min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">${label}</span>
            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" aria-hidden="true" style="flex:0 0 auto;opacity:.9">
              <path d="M6 8l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          `;

          menu.innerHTML = '';
          Array.from(selectEl.options).forEach((opt, idx) => {
            const item = document.createElement('button');
            item.type = 'button';
            item.className = 'ep-select-item';
            item.textContent = opt.textContent;
            item.setAttribute('role', 'option');
            item.setAttribute('aria-selected', idx === selectEl.selectedIndex ? 'true' : 'false');

            item.addEventListener('click', () => {
              selectEl.selectedIndex = idx;
              selectEl.dispatchEvent(new Event('change', { bubbles: true }));
              render();
              close();
            });

            menu.appendChild(item);
          });
        }

        btn.addEventListener('click', (e) => { e.preventDefault(); toggle(); });
        btn.addEventListener('keydown', (e) => { if (e.key === 'Escape') close(); });

        function onDocDown(e){ if (!wrap.contains(e.target)) close(); }
        document.addEventListener('mousedown', onDocDown);

        selectEl.addEventListener('change', render);

        const api = { close, wrap };
        __epSelectInstances.add(api);

        render();
      }

      makePrettySelect(daysCountSelect, { size: 'md' });

      function currentDaysCount(){
        return parseInt(daysCountSelect.value, 10) || 5;
      }

      function syncTeacherDayVisibility(daysCount){
        teacherTbody.querySelectorAll('.t-daylbl[data-d]').forEach(lbl => {
          const idx = parseInt(lbl.dataset.d, 10);
          const cb = lbl.querySelector('input[type="checkbox"]');
          if (idx >= daysCount) {
            lbl.style.display = 'none';
            if (cb) cb.checked = false;
          } else {
            lbl.style.display = 'inline-flex';
          }
        });
      }

      daysCountSelect.addEventListener('change', () => {
        syncTeacherDayVisibility(currentDaysCount());
      });

      function addTeacherRow(initial = {}) {
        const tr = document.createElement('tr');

        const dc = currentDaysCount();
        const defaultAvail = Array.from({ length: dc }, (_, i) => i);
        const available = Array.isArray(initial.availableDays) && initial.availableDays.length
          ? initial.availableDays
          : defaultAvail;

        const daysHtml = DAY_LABELS_FULL.map((lbl, idx) => {
          const checked = available.includes(idx) ? 'checked' : '';
          return `<label class="t-daylbl" data-d="${idx}">
                    <input type="checkbox" class="t-avday" data-d="${idx}" ${checked}>
                    <span>${lbl}</span>
                  </label>`;
        }).join(' ');

        tr.innerHTML = `
          <td><input type="text" class="t-name" placeholder="MÃ¼É™llim adÄ±" value="${initial.name || ''}"></td>
          <td><input type="text" class="t-code" placeholder="Kod" value="${initial.code || ''}"></td>
          <td><input type="number" class="t-week" min="0" max="60" value="${initial.weeklyMax ?? 30}"></td>
          <td><input type="number" class="t-daymax" min="0" max="10" value="${initial.dailyMax ?? 6}"></td>
          <td class="text-center"><input type="checkbox" class="t-avoid-first" ${initial.avoidFirst ? 'checked' : ''}></td>
          <td class="text-center"><input type="checkbox" class="t-avoid-last" ${initial.avoidLast ? 'checked' : ''}></td>
          <td>
            <div class="t-days">
              ${daysHtml}
            </div>
          </td>
          <td class="no-print text-right">
            <button type="button" class="text-xs text-rose-500 hover:underline t-del">Sil</button>
          </td>
        `;
        teacherTbody.appendChild(tr);
        syncTeacherDayVisibility(dc);
      }

      function addClassRow(initial = {}) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="text" class="c-name" placeholder="mÉ™s: 5A" value="${initial.name || ''}"></td>
          <td>
            <select class="c-level">
              <option value="ibtidai" ${initial.level === 'ibtidai' ? 'selected' : ''}>Ä°btidai (1-4)</option>
              <option value="esas" ${initial.level === 'esas' ? 'selected' : ''}>Æsas (5-8)</option>
              <option value="yuxari" ${initial.level === 'yuxari' ? 'selected' : ''}>YuxarÄ± (9-11)</option>
            </select>
          </td>
          <td>
            <select class="c-shift">
              <option value="seher" ${initial.shift === 'seher' ? 'selected' : ''}>SÉ™hÉ™r</option>
              <option value="gunorta" ${initial.shift === 'gunorta' ? 'selected' : ''}>GÃ¼norta</option>
            </select>
          </td>
          <td><input type="number" class="c-maxday" min="0" max="8" placeholder="BoÅŸ: standart" value="${initial.maxPerDay ?? ''}"></td>
          <td class="no-print text-right">
            <button type="button" class="text-xs text-rose-500 hover:underline c-del">Sil</button>
          </td>
        `;
        classTbody.appendChild(tr);

        makePrettySelect(tr.querySelector('.c-level'), { size: 'sm' });
        makePrettySelect(tr.querySelector('.c-shift'), { size: 'sm' });
      }

      function addLessonRow(initial = {}) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="text" class="l-class" placeholder="mÉ™s: 5A" value="${initial.className || ''}"></td>
          <td><input type="text" class="l-subj" placeholder="mÉ™s: Riyaziyyat" value="${initial.subject || ''}"></td>
          <td><input type="text" class="l-teacher" placeholder="Kod vÉ™ ya ad" value="${initial.teacher || ''}"></td>
          <td><input type="number" class="l-hours" min="1" max="40" value="${initial.hours ?? 2}"></td>
          <td class="text-center"><input type="checkbox" class="l-heavy" ${initial.heavy ? 'checked' : ''}></td>
          <td class="text-center"><input type="checkbox" class="l-double" ${initial.double ? 'checked' : ''}></td>
          <td class="no-print text-right">
            <button type="button" class="text-xs text-rose-500 hover:underline l-del">Sil</button>
          </td>
        `;
        lessonTbody.appendChild(tr);
      }

      btnAddTeacher.addEventListener('click', () => addTeacherRow({}));
      btnAddClass.addEventListener('click', () => addClassRow({}));
      btnAddLesson.addEventListener('click', () => addLessonRow({}));

      teacherTbody.addEventListener('click', (e) => {
        if (e.target.classList.contains('t-del')) e.target.closest('tr')?.remove();
      });
      classTbody.addEventListener('click', (e) => {
        if (e.target.classList.contains('c-del')) e.target.closest('tr')?.remove();
      });
      lessonTbody.addEventListener('click', (e) => {
        if (e.target.classList.contains('l-del')) e.target.closest('tr')?.remove();
      });

      btnResetAll.addEventListener('click', () => {
        // running solve varsa lÉ™ÄŸv et
        __stopRequested = true;
        __runId++;
        __solverRunning = false;
        if (btnGenerate) btnGenerate.textContent = GENERATE_LABEL;

        teacherTbody.innerHTML = '';
        classTbody.innerHTML = '';
        lessonTbody.innerHTML = '';
        timetableContainer.innerHTML = '<div class="text-[12px] text-slate-500 dark:text-slate-400">HÉ™lÉ™ cÉ™dvÉ™l qurulmayÄ±b.</div>';
        classTabs.innerHTML = '';
        unplacedContainer.classList.add('hidden');
        unplacedContainer.textContent = '';
        softWarnings.textContent = '';
        resultStats.textContent = '';
        globalError.classList.add('hidden');
        globalError.textContent = '';
        globalInfo.textContent = '';
      });

      function showError(msg){
        globalError.textContent = msg;
        globalError.classList.remove('hidden');
      }

      function readConfig() {
        globalError.classList.add('hidden');
        globalError.textContent = '';

        const daysCount = currentDaysCount();
        const lessonsPerDay = parseInt(document.getElementById('lessonsPerDay').value, 10) || 7;

        const optHeavyAvoidEdges = document.getElementById('optHeavyAvoidEdges').checked;
        const optLimitSameSubject = document.getElementById('optLimitSameSubject').checked;

        const teachers = [];
        teacherTbody.querySelectorAll('tr').forEach(tr => {
          const name = tr.querySelector('.t-name')?.value.trim();
          const code = tr.querySelector('.t-code')?.value.trim();
          if (!name && !code) return;

          const dayCbs = tr.querySelectorAll('.t-avday[data-d]');
          let availableDays = [];
          dayCbs.forEach(cb => {
            if (cb.checked) {
              const idx = parseInt(cb.dataset.d, 10);
              if (!Number.isNaN(idx)) availableDays.push(idx);
            }
          });

          availableDays = availableDays.filter(d => d < daysCount);
          if (!availableDays.length) availableDays = Array.from({ length: daysCount }, (_, i) => i);

          teachers.push({
            id: teachers.length,
            name: name || code,
            code: code || name,
            weeklyMax: Number(tr.querySelector('.t-week')?.value) || 0,
            dailyMax: Number(tr.querySelector('.t-daymax')?.value) || 0,
            avoidFirst: tr.querySelector('.t-avoid-first')?.checked || false,
            avoidLast: tr.querySelector('.t-avoid-last')?.checked || false,
            availableDays
          });
        });

        const classes = [];
        classTbody.querySelectorAll('tr').forEach(tr => {
          const name = tr.querySelector('.c-name')?.value.trim();
          if (!name) return;
          const level = tr.querySelector('.c-level')?.value || 'esas';
          const shift = tr.querySelector('.c-shift')?.value || 'seher';
          const maxDay = Number(tr.querySelector('.c-maxday')?.value) || 0;
          classes.push({
            id: classes.length,
            name,
            level,
            shift,
            maxPerDay: maxDay
          });
        });

        const lessons = [];
        lessonTbody.querySelectorAll('tr').forEach(tr => {
          const className = tr.querySelector('.l-class')?.value.trim();
          const subject   = tr.querySelector('.l-subj')?.value.trim();
          const teacher   = tr.querySelector('.l-teacher')?.value.trim();
          const hours     = Number(tr.querySelector('.l-hours')?.value) || 0;
          if (!className || !subject || !teacher || hours <= 0) return;

          lessons.push({
            className,
            subject,
            teacherRef: teacher,
            hours,
            heavy: tr.querySelector('.l-heavy')?.checked || false,
            double: tr.querySelector('.l-double')?.checked || false
          });
        });

        if (!teachers.length || !classes.length || !lessons.length) {
          throw new Error('HeÃ§ olmasa 1 mÃ¼É™llim, 1 sinif vÉ™ 1 dÉ™rs É™lavÉ™ etmÉ™lisÉ™n.');
        }
        if (lessonsPerDay > 8 || lessonsPerDay < 1) {
          throw new Error('GÃ¼ndÉ™ dÉ™rs saatÄ± 1â€“8 aralÄ±ÄŸÄ±nda olmalÄ±dÄ±r.');
        }

        return {
          daysCount,
          lessonsPerDay,
          optHeavyAvoidEdges,
          optLimitSameSubject,
          teachers,
          classes,
          lessons,

          // solver internal cache (hÉ™r run-da doldurulur)
          _blocks: null,
          _targetHours: 0
        };
      }

      function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [arr[i], arr[j]] = [arr[j], arr[i]];
        }
      }

      function defaultMaxPerDayByLevel(level) {
        if (level === 'ibtidai') return 6;
        if (level === 'esas') return 7;
        return 8;
      }

      function generateBlocks(config) {
        const { lessons, classes, teachers } = config;
        const classIndexByName = new Map();
        classes.forEach(c => classIndexByName.set(c.name.trim(), c.id));

        const teacherIndexByKey = new Map();
        teachers.forEach(t => {
          if ((t.code || '').trim()) teacherIndexByKey.set((t.code || '').trim(), t.id);
          if ((t.name || '').trim()) teacherIndexByKey.set((t.name || '').trim(), t.id);
        });

        const blocks = [];
        const unknown = [];

        lessons.forEach(l => {
          const cId = classIndexByName.get(l.className.trim());
          const tId = teacherIndexByKey.get(l.teacherRef.trim());
          if (cId == null || tId == null) {
            unknown.push(l);
            return;
          }
          let remaining = l.hours;
          const base = {
            classId: cId,
            teacherId: tId,
            subject: l.subject,
            heavy: !!l.heavy
          };

          // QoÅŸa dÉ™rslÉ™r: 2-lik bloklar
          if (l.double && remaining >= 2) {
            while (remaining >= 2) {
              blocks.push({ ...base, length: 2 });
              remaining -= 2;
            }
          }
          // Qalan 1-liklÉ™r
          while (remaining > 0) {
            blocks.push({ ...base, length: 1 });
            remaining -= 1;
          }
        });

        // Daha Ã§É™tin bloklar É™vvÉ™l (uzun + aÄŸÄ±r)
        blocks.sort((a, b) => {
          if (b.length !== a.length) return b.length - a.length;
          if (b.heavy !== a.heavy) return (b.heavy ? 1 : 0) - (a.heavy ? 1 : 0);
          return 0;
        });

        return { blocks, unknownUnmapped: unknown };
      }

      function sumRequiredHours(lessons){
        return lessons.reduce((sum, l) => sum + (Number(l.hours) || 0), 0);
      }

      function prepareSolve(config){
        const { blocks, unknownUnmapped } = generateBlocks(config);

        // âœ… uyÄŸun gÉ™lmÉ™yÉ™n sÉ™tirlÉ™r varsa É™vvÉ™lcÉ™dÉ™n dayandÄ±r (yoxsa sonsuz axtarÄ±ÅŸa dÃ¼ÅŸÉ™r)
        if (unknownUnmapped && unknownUnmapped.length){
          const lines = unknownUnmapped.map(l => `â€¢ ${l.className} â€“ ${l.subject} (${l.teacherRef})`);
          throw new Error(
            'BÉ™zi dÉ™rslÉ™r Ã¼Ã§Ã¼n sinif vÉ™ ya mÃ¼É™llim tapÄ±lmadÄ± (yazÄ±lÄ±ÅŸlarÄ± yoxlayÄ±n):\n' + lines.join('\n')
          );
        }

        config._blocks = blocks;
        config._targetHours = blocks.reduce((s, b) => s + b.length, 0);

        // âœ… sÃ¼rÉ™tli â€œzÉ™manÉ™tli mÃ¼mkÃ¼nsÃ¼zâ€ yoxlamalar
        const teacherHours = new Array(config.teachers.length).fill(0);
        const classHours = new Array(config.classes.length).fill(0);

        blocks.forEach(b => {
          teacherHours[b.teacherId] += b.length;
          classHours[b.classId] += b.length;
        });

        teacherHours.forEach((h, tId) => {
          const t = config.teachers[tId];
          if (!t) return;
          const label = t.code || t.name || `#${tId}`;

          if (t.weeklyMax > 0 && h > t.weeklyMax) {
            throw new Error(`MÃ¼mkÃ¼nsÃ¼z konfiqurasiya: "${label}" mÃ¼É™lliminÉ™ ${h} saat dÃ¼ÅŸÃ¼r, amma hÉ™ftÉ™lik max ${t.weeklyMax}-dÄ±r.`);
          }

          if (t.dailyMax > 0) {
            const daysAvail = (Array.isArray(t.availableDays) && t.availableDays.length)
              ? t.availableDays.length
              : config.daysCount;
            const cap = t.dailyMax * daysAvail;
            if (h > cap) {
              throw new Error(`MÃ¼mkÃ¼nsÃ¼z konfiqurasiya: "${label}" mÃ¼É™lliminÉ™ ${h} saat dÃ¼ÅŸÃ¼r, amma gÃ¼ndÉ™ max ${t.dailyMax} vÉ™ gÉ™lmÉ™ gÃ¼nlÉ™ri ${daysAvail} â†’ maksimum ${cap} saat.`);
            }
          }
        });

        classHours.forEach((h, cId) => {
          const c = config.classes[cId];
          if (!c) return;
          const maxDay = c.maxPerDay > 0 ? c.maxPerDay : defaultMaxPerDayByLevel(c.level);
          const cap = maxDay * config.daysCount;

          if (h > cap) {
            throw new Error(`MÃ¼mkÃ¼nsÃ¼z konfiqurasiya: "${c.name}" sinfindÉ™ ${h} saat var, amma tutum ${cap}-dÄ±r (gÃ¼ndÉ™ ${maxDay} Ã— ${config.daysCount} gÃ¼n).`);
          }
        });

        return config;
      }

      function attemptBuild(config) {
        const { daysCount, lessonsPerDay, teachers, classes, optHeavyAvoidEdges, optLimitSameSubject } = config;

        const baseBlocks = (Array.isArray(config._blocks) && config._blocks.length)
          ? config._blocks
          : generateBlocks(config).blocks;

        // hÉ™r cÉ™hddÉ™ sÄ±ranÄ± random etmÉ™k Ã¼Ã§Ã¼n kopya
        const blocks = baseBlocks.slice();
        shuffle(blocks);

        const timetable = {};
        classes.forEach(c => {
          const matrix = [];
          for (let d = 0; d < daysCount; d++) matrix.push(new Array(lessonsPerDay).fill(null));
          timetable[c.id] = matrix;
        });

        const teacherWeekly = new Array(teachers.length).fill(0);
        const teacherDaily  = new Array(teachers.length).fill(null).map(() => new Array(daysCount).fill(0));
        const classDaily    = new Array(classes.length).fill(null).map(() => new Array(daysCount).fill(0));
        const classSubjPerDay = new Array(classes.length).fill(null).map(() => Object.create(null));

        const unplaced = [];
        const lastSlotIndex = lessonsPerDay - 1;

        function canPlace(block, day, slot, strict) {
          const { classId, teacherId, subject, length, heavy } = block;
          if (slot + length - 1 >= lessonsPerDay) return false;

          const matrix = timetable[classId];
          for (let i = 0; i < length; i++) {
            if (matrix[day][slot + i] != null) return false;
          }

          const t = teachers[teacherId];
          if (!t) return false;

          // sÉ™rt: gÉ™lmÉ™ gÃ¼nlÉ™ri
          if (Array.isArray(t.availableDays) && t.availableDays.length) {
            if (!t.availableDays.includes(day)) return false;
          }

          // sÉ™rt: eyni slotda mÃ¼É™llim konflikt olmasÄ±n (digÉ™r siniflÉ™r)
          for (let i = 0; i < length; i++) {
            for (const c of classes) {
              const m = timetable[c.id];
              if (m[day][slot + i] && m[day][slot + i].block.teacherId === teacherId) return false;
            }
          }

          // sÉ™rt: mÃ¼É™llim limitlÉ™ri
          const weeklyMax = t.weeklyMax > 0 ? t.weeklyMax : Infinity;
          const dailyMax  = t.dailyMax > 0 ? t.dailyMax : Infinity;
          if (teacherWeekly[teacherId] + length > weeklyMax) return false;
          if (teacherDaily[teacherId][day] + length > dailyMax) return false;

          // sÉ™rt: sinif gÃ¼ndÉ™lik limit
          const cls = classes[classId];
          const maxDay = cls.maxPerDay > 0 ? cls.maxPerDay : defaultMaxPerDayByLevel(cls.level);
          if (classDaily[classId][day] + length > maxDay) return false;

          // yumÅŸaq qaydalar (strict stage)
          if (strict) {
            if (optHeavyAvoidEdges && heavy) {
              if (slot === 0) return false;
              if (slot + length - 1 === lastSlotIndex) return false;
            }
            if (t.avoidFirst && slot === 0) return false;
            if (t.avoidLast && (slot + length - 1 === lastSlotIndex)) return false;

            if (optLimitSameSubject) {
              const subjMap = classSubjPerDay[classId];
              subjMap[subject] = subjMap[subject] || new Array(daysCount).fill(0);
              if (subjMap[subject][day] + length > 2) return false;
            }
          }

          return true;
        }

        function place(block, day, slot) {
          const { classId, teacherId, subject, length } = block;
          const matrix = timetable[classId];
          for (let i = 0; i < length; i++) matrix[day][slot + i] = { block, part: i };

          teacherWeekly[teacherId] += length;
          teacherDaily[teacherId][day] += length;
          classDaily[classId][day] += length;

          const subjMap = classSubjPerDay[classId];
          subjMap[subject] = subjMap[subject] || new Array(daysCount).fill(0);
          subjMap[subject][day] += length;
        }

        function tryPlaceBlock(block) {
          const candidates = [];
          for (let d = 0; d < daysCount; d++) {
            for (let s = 0; s < lessonsPerDay; s++) candidates.push({ d, s });
          }
          shuffle(candidates);

          // 1) É™vvÉ™l strict
          for (const { d, s } of candidates) {
            if (canPlace(block, d, s, true)) { place(block, d, s); return true; }
          }
          // 2) sonra soft-larÄ± yumÅŸalt
          for (const { d, s } of candidates) {
            if (canPlace(block, d, s, false)) { place(block, d, s); return true; }
          }
          return false;
        }

        let placedCount = 0;
        blocks.forEach(b => {
          const ok = tryPlaceBlock(b);
          if (!ok) unplaced.push(b);
          else placedCount += b.length;
        });

        return { timetable, unplaced, placedCount };
      }

      async function buildUntilSolved(config, shouldStop){
        const target = Number(config._targetHours) || sumRequiredHours(config.lessons);
        const startedAt = performance.now();

        const BATCH = 300; // â€œcihaz gÃ¼cÃ¼ nÉ™zÉ™rÉ™ alÄ±nmasÄ±nâ€ dedin â€” batch-i yÃ¼ksÉ™k saxladÄ±m

        let attempts = 0;
        let best = null;

        function isBetter(a, b){
          if (!b) return true;
          if (a.placedCount !== b.placedCount) return a.placedCount > b.placedCount;
          return (a.unplaced?.length || 0) < (b.unplaced?.length || 0);
        }

        while (true) {
          for (let i = 0; i < BATCH; i++) {
            if (shouldStop && shouldStop()) {
              if (!best) best = { timetable: {}, unplaced: [], placedCount: 0 };
              best.stopped = true;
              best.attemptsUsed = attempts;
              best.targetHours = target;
              return best;
            }

            attempts++;
            const res = attemptBuild(config);
            res.attemptsUsed = attempts;
            res.targetHours = target;

            if (isBetter(res, best)) best = res;

            // âœ… 100% hÉ™ll tapÄ±ldÄ±sa dÉ™rhal Ã§Ä±x
            if (res.placedCount >= target) {
              best = res;
              best.solved = true;
              return best;
            }
          }

          // Progress
          const bestPlaced = best ? best.placedCount : 0;
          const pct = target > 0 ? ((bestPlaced / target) * 100).toFixed(1) : '0.0';
          const elapsed = ((performance.now() - startedAt) / 1000).toFixed(1);

          if (globalInfo) {
            globalInfo.textContent =
              `AxtarÄ±ÅŸ davam edirâ€¦ CÉ™hd: ${attempts.toLocaleString('az-AZ')} Â· Æn yaxÅŸÄ±: ${bestPlaced}/${target} (${pct}%) Â· ${elapsed}s`;
          }

          // UI donmasÄ±n deyÉ™ yield (amma limit yoxdur â€” sadÉ™cÉ™ â€œfreezeâ€ etmÉ™sin)
          await new Promise(r => requestAnimationFrame(r));
        }
      }

      function teacherLabel(teachers, tId) {
        const t = teachers[tId];
        if (!t) return '';
        if (t.code && t.name) return `${t.code}`;
        return t.code || t.name || '';
      }

      function renderTimetable(config, result) {
        const { classes, teachers, daysCount, lessonsPerDay } = config;
        const { timetable, unplaced, placedCount } = result;

        const daysLabels = (daysCount === 5 ? DAYS_LABELS_5 : DAYS_LABELS_6).slice(0, daysCount);

        classTabs.innerHTML = '';
        classes.forEach((c, idx) => {
          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'tab-btn' + (idx === 0 ? ' active' : '');
          btn.textContent = c.name;
          btn.dataset.classId = c.id;
          classTabs.appendChild(btn);
        });

        function renderForClass(classId) {
          const matrix = timetable[classId];
          if (!matrix) {
            timetableContainer.innerHTML = '<div class="text-[12px] text-slate-500 dark:text-slate-400">Bu sinif Ã¼Ã§Ã¼n cÉ™dvÉ™l tapÄ±lmadÄ±.</div>';
            return;
          }

          let html = '<table class="tt-table"><thead><tr><th>Saat</th>';
          daysLabels.forEach(d => { html += `<th>${d}</th>`; });
          html += '</tr></thead><tbody>';

          for (let s = 0; s < lessonsPerDay; s++) {
            html += `<tr><th>${s + 1}</th>`;
            for (let d = 0; d < daysCount; d++) {
              const cell = matrix[d][s];
              if (!cell) {
                html += `<td><span class="tt-slot-muted">â€”</span></td>`;
              } else if (cell.part === 0) {
                const b = cell.block;
                const subj = b.subject;
                const tLab = teacherLabel(teachers, b.teacherId);
                const rowspan = b.length > 1 ? b.length : 1;
                html += `<td rowspan="${rowspan}">
                          <div class="font-semibold">${subj}</div>
                          <div class="text-[10px] mt-0.5 text-slate-500 dark:text-slate-400">${tLab}</div>
                        </td>`;
              } else {
                // rowspan-a gÃ¶rÉ™ boÅŸ qalÄ±r
              }
            }
            html += '</tr>';
          }

          html += '</tbody></table>';
          timetableContainer.innerHTML = html;
        }

        const totalRequiredHours =
          Number(result.targetHours) ||
          Number(config._targetHours) ||
          sumRequiredHours(config.lessons);

        const placedPercent = totalRequiredHours > 0 ? ((placedCount / totalRequiredHours) * 100).toFixed(1) : '0.0';
        const attemptsUsed = result.attemptsUsed ?? 0;

        resultStats.textContent =
          `YerlÉ™ÅŸdirilÉ™n saat: ${placedCount}/${totalRequiredHours} (${placedPercent}%) Â· CÉ™hd: ${attemptsUsed.toLocaleString('az-AZ')}`;

        if (unplaced && unplaced.length) {
          const lines = unplaced.map(b => {
            const cls = classes[b.classId]?.name || '?';
            const t = teachers[b.teacherId];
            const tLabel = t ? (t.code || t.name) : '?';
            return `â€¢ ${cls} â€“ ${b.subject} (${tLabel}), ${b.length} saat`;
          });
          unplacedContainer.classList.remove('hidden');
          unplacedContainer.textContent = 'YerlÉ™ÅŸdirilmÉ™yÉ™nlÉ™r:\n' + lines.join('\n');
        } else {
          unplacedContainer.classList.add('hidden');
          unplacedContainer.textContent = '';
        }

        softWarnings.textContent =
          'Qeyd: MÃ¼É™llim istÉ™klÉ™ri (1-ci / sonuncu saatdan qaÃ§maq), aÄŸÄ±r fÉ™nnin paylanmasÄ± vÉ™ eyni fÉ™nnin gÃ¼ndÉ™ 2-dÉ™n Ã§ox olmamasÄ± É™vvÉ™lcÉ™ sÉ™rt ÅŸÉ™kildÉ™ nÉ™zÉ™rÉ™ alÄ±nÄ±r, ' +
          'yer tapÄ±lmadÄ±qda isÉ™ bu istÉ™klÉ™r yumÅŸaldÄ±lÄ±r (gÉ™lmÉ™ gÃ¼nlÉ™ri vÉ™ limitlÉ™r saxlanÄ±lÄ±r).';

        const firstClassId = classes[0]?.id;
        if (firstClassId != null) renderForClass(firstClassId);

        classTabs.onclick = (e) => {
          const btn = e.target.closest('.tab-btn');
          if (!btn) return;
          classTabs.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          renderForClass(Number(btn.dataset.classId));
        };
      }

      btnGenerate.addEventListener('click', async () => {
        // ÆgÉ™r artÄ±q axtarÄ±ÅŸ gedirsÉ™ â€” klik â€œdayandÄ±râ€ kimi iÅŸlÉ™sin
        if (__solverRunning) {
          __stopRequested = true;
          if (globalInfo) globalInfo.textContent = 'DayandÄ±rÄ±lÄ±râ€¦';
          return;
        }

        const myRun = ++__runId;
        __solverRunning = true;
        __stopRequested = false;

        if (btnGenerate) btnGenerate.textContent = STOP_LABEL;

        try {
          let config = readConfig();
          config = prepareSolve(config);

          globalError.classList.add('hidden');
          globalError.textContent = '';

          if (globalInfo) globalInfo.textContent = 'AxtarÄ±ÅŸ baÅŸlayÄ±râ€¦ (tam hÉ™ll tapÄ±lanadÉ™k cÉ™hd edilÉ™cÉ™k)';

          const result = await buildUntilSolved(config, () => __stopRequested || myRun !== __runId);

          // reset / yeni run olduysa nÉ™ticÉ™ni gÃ¶stÉ™rmÉ™
          if (myRun !== __runId) return;

          renderTimetable(config, result);

          const target = Number(result.targetHours) || Number(config._targetHours) || sumRequiredHours(config.lessons);
          const bestPlaced = result.placedCount || 0;
          const pct = target > 0 ? ((bestPlaced / target) * 100).toFixed(1) : '0.0';

          if (result.solved) {
            if (globalInfo) globalInfo.textContent =
              `CÉ™dvÉ™l 100% quruldu. (CÉ™hd: ${(result.attemptsUsed || 0).toLocaleString('az-AZ')})`;
          } else if (result.stopped) {
            if (globalInfo) globalInfo.textContent =
              `DayandÄ±rÄ±ldÄ±. Æn yaxÅŸÄ± nÉ™ticÉ™: ${bestPlaced}/${target} (${pct}%).`;
          } else {
            if (globalInfo) globalInfo.textContent = 'CÉ™dvÉ™l quruldu.';
          }
        } catch (err) {
          if (myRun !== __runId) return;
          showError(err.message || String(err));
          if (globalInfo) globalInfo.textContent = '';
        } finally {
          if (myRun === __runId) {
            __solverRunning = false;
            __stopRequested = false;
            if (btnGenerate) btnGenerate.textContent = GENERATE_LABEL;
          }
        }
      });

      // BaÅŸlanÄŸÄ±c nÃ¼munÉ™lÉ™r (istÉ™sÉ™n sil)
      addTeacherRow({ name: 'ÆhmÉ™dov Firdovsi', code: 'FÄ°R', weeklyMax: 24, dailyMax: 6, avoidFirst: false, avoidLast: true, availableDays: [0,1,2,3,4] });
      addTeacherRow({ name: 'Ä°sfÉ™ndiyarlÄ± MÉ™zahir', code: 'MÆZ', weeklyMax: 24, dailyMax: 6, avoidFirst: false, avoidLast: false, availableDays: [0,1,2,3,4] });

      addClassRow({ name: '5A', level: 'esas', shift: 'seher' });
      addClassRow({ name: '6A', level: 'esas', shift: 'seher' });

      addLessonRow({ className: '5A', subject: 'Riyaziyyat', teacher: 'FÄ°R', hours: 4, heavy: true, double: true });
      addLessonRow({ className: '5A', subject: 'AzÉ™rbaycan dili', teacher: 'MÆZ', hours: 3, heavy: false, double: false });

      // ilkin state
      syncTeacherDayVisibility(currentDaysCount());
    })();
  </script>
</body>
</html>
