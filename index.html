<!doctype html>
<html lang="az">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EduPlan</title>
  <!-- Favicon: light/dark -->
<link id="fav-light" rel="icon" type="image/svg+xml" media="(prefers-color-scheme: light)" href="assets/ep-favicon-light.svg">
<link id="fav-dark"  rel="icon" type="image/svg+xml" media="(prefers-color-scheme: dark)"  href="assets/ep-favicon-dark.svg">
<link id="apple-icon" rel="apple-touch-icon" href="assets/ep-favicon-light.svg">
<script>
  window.__catalogPromise = fetch("https://drive.usercontent.google.com/uc?export=download&id=YOUR_CATALOG_JSON_ID")
    .then(r => r.json())
    .catch(()=>[]);
</script>
  <!-- Tailwind (no install) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }
    /* === DARK MODE === */
:root {
  --bg-from: #f8fafc;  
  --bg-to:   #ffffff;
  --text:    #0f172a;
  --card:    #ffffff;
  --muted:   #475569;
  --border:  #e2e8f0;
  --tab-track:#eef2f6;
  --pill:#e9edf3;
  --pill-text:#334155;
}
.dark {
  --bg-from: #0b1220;  
  --bg-to:   #0a0f1a;
  --text:    #e2e8f0;
  --card:    #0f172a;
  --muted:   #cbd5e1;
  --border:  #334155;
  --tab-track:#111827;
  --pill:#0f172a;
  --pill-text:#cbd5e1;
}
/* badge-l…ôr, tab-lar, button-lar √º√ß√ºn d√ºz…ôli≈ül…ôr */
.bg-slate-100\/80{ background-color:var(--tab-track)!important; }
.bg-slate-100{ background-color:var(--pill)!important; }
.badge, .pill, .inline-badge{
  background-color:var(--pill)!important;
  color:var(--pill-text)!important;
}
/* …ôsas fond v…ô m…ôtn */
body { color: var(--text); }
body.bg-gradient-to-b { 
  background-image: linear-gradient(to bottom, var(--bg-from), var(--bg-to)) !important;
}
/* kartlar v…ô panell…ôr */
.bg-white { background-color: var(--card) !important; }
.text-slate-900, .text-slate-800, .text-slate-700 { color: var(--text) !important; }
.text-slate-600, .text-slate-500 { color: var(--muted) !important; }
/* s…ôrh…ôdl…ôr */
.border-slate-200 { border-color: var(--border) !important; }
/* header blur fonu */
.backdrop-blur.bg-white\/70 { background-color: color-mix(in srgb, var(--card) 70%, transparent) !important; }
/* input/select fonu */
select, input { background-color: var(--card) !important; color: var(--text) !important; }
/* ‚ÄúA√ß / Y√ºkl…ô‚Äù d√ºym…ôsi dark √º√ß√ºn kontrastlƒ± qalsƒ±n */
.bg-slate-900 { background-color:#0b1220 !important; color:#fff !important; }
#dark-toggle:checked + span { background:#334155; }
#dark-toggle:checked + span .dot { transform: translateX(16px); }
/* --- Tab ke√ßid animasiyasƒ± --- */
.tab-panel {
  display: none;           /* ilkin v…ôziyy…ôt: gizli */
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 220ms ease, transform 220ms ease;
}

.tab-panel.is-active {
  display: block;          /* g√∂r√ºn…ôn panel */
  opacity: 1;
  transform: translateY(0);
}

/* grid panell…ôri √º√ß√ºn (s…ônd…ô b…ôzil…ôri grid-dir) */
.tab-panel.grid-on.is-active { display: grid; }

/* Tab d√ºym…ôsi √º√ß√ºn vizual aktivlik */
.tab-btn {
  transition: background-color 180ms ease, color 180ms ease, box-shadow 180ms ease, transform 120ms ease;
}
.tab-btn[aria-selected="true"] {
  background-color: var(--card);
  color: var(--text);
  box-shadow: 0 1px 4px rgba(0,0,0,.06);
  transform: translateY(-1px);
}
/* DARK: tray v…ô aktiv d√ºym…ô √º√ß√ºn daha y√ºks…ôk kontrast */
.dark #tabs{
  background:#0f172a;              /* tray fonu */
  border-color:#253046;
}
.dark .tab-btn[aria-selected="true"]{
  background:#1e293b;              /* aktiv tab fonu ‚Äì traydan a√ßƒ±q */
  color:#e5e7eb;
  box-shadow:
    0 0 0 1px #304155,             /* nazik ring */
    0 8px 16px rgba(0,0,0,.35);
}
/* DARK: passiv tabƒ± bir az solƒüun g√∂st…ôr */
.dark .tab-btn[aria-selected="false"]{
  color:#94a3b8;
  opacity:.9;
}
/* H…ôr iki rejimd…ô aktiv tab altƒ±nda indikator x…ôtti */
.tab-btn[aria-selected="true"]{ position:relative; }
.tab-btn[aria-selected="true"]::after{
  content:"";
  position:absolute; left:12px; right:12px; bottom:-7px;
  height:3px; border-radius:9999px;
  background:linear-gradient(90deg,#22d3ee,#a78bfa);
  opacity:.95;
}
/* Kartlarƒ±n hover k√∂lg…ôsi */
.bg-white {
  transition: box-shadow 0.2s ease;
}

.bg-white:hover {
  box-shadow: 0 6px 16px rgba(0,0,0,0.12); /* Light mode k√∂lg…ô */
}

/* Dark mod √º√ß√ºn hover k√∂lg…ôsi */
.dark .bg-white:hover {
  box-shadow: 0 6px 16px rgba(255,255,255,0.15); /* A√ßƒ±q k√∂lg…ô */
}
select:invalid { color:#9aa4b2; }
    
  </style>
<link rel="dns-prefetch" href="https://drive.usercontent.google.com">
<link rel="preconnect" href="https://drive.usercontent.google.com" crossorigin>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-900 relative">
  <div class="pointer-events-none absolute inset-0 -z-10 overflow-hidden">
    <div class="absolute -top-24 -right-24 h-72 w-72 rounded-full blur-3xl bg-gradient-to-tr from-indigo-200/50 to-emerald-200/50"></div>
    <div class="absolute -bottom-24 -left-24 h-72 w-72 rounded-full blur-3xl bg-gradient-to-tr from-amber-200/40 to-pink-200/40"></div>
  </div>

  <header class="sticky top-0 z-50 backdrop-blur bg-white/70 border-b border-slate-200">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <div class="flex items-center gap-3">
<!-- Header loqo -->
<img id="site-logo" src="assets/ep-favicon-light.svg" alt="EduPlan loqo" class="h-9 w-9 rounded-2xl shadow-sm" loading="eager" decoding="async">
        <span class="font-semibold tracking-tight">EduPlan AZ</span>
      </div>
      <div class="relative flex items-center gap-3" id="header-controls">
        <button id="btn-settings" class="rounded-2xl border px-3 py-2 text-sm">‚öôÔ∏è <span data-i18n="nav.settings">T…ônziml…ôm…ôl…ôr</span></button>
        <!-- Settings popover -->
<div id="settings-panel"
       class="hidden absolute right-0 top-12 z-[60] w-64 rounded-2xl border border-slate-200 bg-white p-4 shadow-lg">
    <div class="flex items-center justify-between">
      <div class="text-sm">üåô Qaranlƒ±q rejim</div>
      <label class="inline-flex items-center cursor-pointer">
        <input id="dark-toggle" type="checkbox" class="sr-only">
        <span class="w-10 h-6 bg-slate-200 rounded-full relative transition">
          <span class="dot absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition"></span>
        </span>
      </label>
    </div>
  </div>
</div>

    </div>
  </header>

  <section class="relative">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-12 lg:py-16 grid lg:grid-cols-2 gap-8 items-center">
      <div>
        <h1 id="hero-title" class="text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight leading-snug whitespace-normal text-balance text-pretty max-w-[28ch] sm:max-w-[32ch] lg:max-w-[36ch]">T…ôdris resurslarƒ±nƒ± saniy…ôl…ôr i√ßind…ô tap v…ô y√ºkl…ô</h1>
        <p class="mt-4 text-slate-600 text-lg" id="hero-subtitle">Sad…ô interfeys, premium g√∂r√ºn√º≈ü, Az…ôrbaycan m…ôkt…ôbl…ôri √º√ß√ºn uyƒüunla≈üdƒ±rƒ±lƒ±b.</p>
        <div class="mt-6 flex items-center gap-3 text-sm text-slate-600">
          <span class="inline-flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-500 inline-block"></span><span id="hero-b1">KSQ/BSQ & PP</span></span>
          <span class="inline-flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-indigo-500 inline-block"></span><span id="hero-b2">Al…ôtl…ôr & Testl…ôr</span></span>
          <span class="inline-flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-amber-500 inline-block"></span><span id="hero-b3">PDF/DOCX</span></span>
        </div>
      </div>
      <div class="grid gap-4">
        <div class="grid sm:grid-cols-2 gap-4">
          <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
            <div class="p-4">
              <div class="text-base font-semibold">üìÑ <span id="feat-ksq-title">KSQ/BSQ</span></div>
              <div class="text-sm text-slate-600 mt-1" id="feat-ksq-desc">Sinif, f…ônn, n√∂v v…ô n√∂mr…ô √ºzr…ô summativ qiym…ôtl…ôndirm…ô fayllarƒ±.</div>
            </div>
          </div>
          <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
            <div class="p-4">
              <div class="text-base font-semibold">üìÖ <span id="feat-pp-title">Perspektiv plan (PP)</span></div>
              <div class="text-sm text-slate-600 mt-1" id="feat-pp-desc">F…ônn √ºzr…ô illik plan fayllarƒ±.</div>
            </div>
          </div>
        </div>
        <div class="grid sm:grid-cols-3 gap-4">
          <div class="rounded-2xl bg-white border p-4 shadow-sm hover:shadow-md transition flex items-center gap-2">üßÆ <span id="mini-calc">Bal kalkulyatoru</span></div>
          <div class="rounded-2xl bg-white border p-4 shadow-sm hover:shadow-md transition flex items-center gap-2">üìö <span id="mini-templates">Sual bankƒ±</span></div>
          <div class="rounded-2xl bg-white border p-4 shadow-sm hover:shadow-md transition flex items-center gap-2">‚¨áÔ∏è <span id="mini-export">ƒ∞xrac</span></div>
        </div>
      </div>
    </div>
  </section>

  <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-16">
    <div id="tabs" class="mt-2 grid grid-cols-3 rounded-2xl p-1 bg-slate-100/80 border border-slate-200 shadow-inner">
      <button data-tab="ksq" class="tab-btn rounded-xl px-4 py-2 text-sm text-slate-600" id="tab-ksq">KSQ / BSQ</button>
      <button data-tab="pp"  class="tab-btn rounded-xl px-4 py-2 text-sm text-slate-600" id="tab-pp">Perspektiv plan</button>
      <button data-tab="tools" class="tab-btn rounded-xl px-4 py-2 text-sm text-slate-600" id="tab-tools">Al…ôtl…ôr & Testl…ôr</button>
    </div>

    <section id="panel-ksq" class="tab-panel is-active mt-6">
      <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
        <div class="p-4 border-b"><h3 class="font-semibold" id="ksq-title">KSQ/BSQ</h3></div>
        <div class="p-4 grid lg:grid-cols-3 gap-6">
          <div class="space-y-4">
            <div><label class="text-sm text-slate-700 block" id="lbl-grade">Sinif</label>
              <select id="grade" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1"></select></div>
            <div><label class="text-sm text-slate-700 block" id="lbl-subject">F…ônn</label>
              <select id="subject" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1"></select></div>
            <div><label class="text-sm text-slate-700 block" id="lbl-type">N√∂v</label>
              <select id="ksqType" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1">
                <option>KSQ</option><option>BSQ</option></select></div>
            <div id="wrap-ksqNo"><label class="text-sm text-slate-700 block" id="lbl-ksqNo">KSQ n√∂mr…ôsi</label>
              <select id="ksqIndex" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1"></select></div>
            <div id="wrap-bsqNo" class="hidden"><label class="text-sm text-slate-700 block" id="lbl-bsqNo">BSQ n√∂mr…ôsi</label>
              <select id="bsqIndex" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1"></select></div>
          </div>
<div class="lg:col-span-2 grid lg:grid-cols-3 gap-4">

  <!-- N…ôtic…ôl…ôr (…ôvv…ôlki kart eynidir) -->
  <div class="lg:col-span-2 rounded-xl border border-slate-200 bg-white p-4 text-sm" id="ksq-results-card">
    <div class="flex items-center justify-end mb-3">
      <span class="inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-xs text-slate-600 border" id="ksq-count">0</span>
    </div>
<div id="ksq-results-wrap" class="flex-1">
  <div id="ksq-results" class="grid sm:grid-cols-2 gap-3"></div>
</div>
  </div>

  <!-- REKLAM ZONASI (placeholder) -->
  <aside id="ad-ksq"
         class="rounded-xl border border-slate-200 bg-gradient-to-br from-indigo-500/90 to-purple-600/90
                p-4 flex items-center justify-center text-white shadow-md min-h-[180px]">
    <div class="text-center">
      <div class="text-lg font-bold">ü™ß Reklam zonasƒ±</div>
      <div class="text-sm opacity-90">Burada Google Ads g√∂r√ºn…ôc…ôk</div>
    </div>
  </aside>

</div>

        </div>
      </div>
    </section>

    <section id="panel-pp"  class="tab-panel mt-6">
      <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
        <div class="p-4 border-b"><h3 class="font-semibold" id="pp-title">Perspektiv (illik) plan</h3></div>
        <div class="p-4 grid lg:grid-cols-3 gap-6">
          <div class="space-y-4">
            <div><label class="text-sm text-slate-700 block" id="lbl-pp-subject">F…ônn</label>
              <select id="ppSubject" class="w-full rounded-xl border px-3 py-2 text-sm bg-white mt-1"></select></div>
          </div>
<div class="lg:col-span-2 grid lg:grid-cols-3 gap-4">

  <!-- N…ôtic…ôl…ôr -->
  <div class="lg:col-span-2 rounded-xl border border-slate-200 bg-white p-4 text-sm" id="pp-results-card">
    <div class="flex items-center justify-end mb-3">
      <span class="inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-xs text-slate-600 border" id="pp-count">0</span>
    </div>
<div id="pp-results-wrap" class="flex-1">
  <div id="pp-results" class="grid sm:grid-cols-2 gap-3"></div>
</div>
  </div>

  <!-- REKLAM ZONASI (placeholder) -->
  <aside id="ad-pp"
         class="rounded-xl border border-slate-200 bg-gradient-to-br from-indigo-500/90 to-purple-600/90
                p-4 flex items-center justify-center text-white shadow-md min-h-[180px]">
    <div class="text-center">
      <div class="text-lg font-bold">ü™ß Reklam zonasƒ±</div>
      <div class="text-sm opacity-90">Burada Google Ads g√∂r√ºn…ôc…ôk</div>
    </div>
  </aside>

</div>

        </div>
      </div>
    </section>

    <section id="panel-tools" class="tab-panel grid-on mt-6">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
          <div class="p-4 border-b"><div class="text-base font-semibold">üßÆ <span id="tool-calc-title">Bal kalkulyatoru</span></div></div>
          <div class="p-4 space-y-3">
            <div class="grid grid-cols-2 gap-3">
              <input type="number" placeholder="KSQ1" class="rounded-xl border px-3 py-2 text-sm" />
              <input type="number" placeholder="KSQ2" class="rounded-xl border px-3 py-2 text-sm" />
              <input type="number" placeholder="KSQ3" class="rounded-xl border px-3 py-2 text-sm" />
              <input type="number" placeholder="KSQ4" class="rounded-xl border px-3 py-2 text-sm" />
            </div>
            <input type="number" placeholder="BSQ" class="rounded-xl border px-3 py-2 text-sm" />
            <button class="rounded-2xl w-full mt-2 bg-slate-900 text-white px-4 py-2 text-sm" id="btn-calc">Hesabla</button>
          </div>
        </div>

        <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
          <div class="p-4 border-b"><div class="text-base font-semibold">üìÑ <span id="tool-templates-title">≈ûablon kitabxanasƒ±</span></div></div>
          <div class="p-4">
            <div class="flex flex-wrap gap-2 mb-3">
              <span class="rounded-full border px-2 py-1 text-xs">KSQ n√ºmun…ôl…ôri</span>
              <span class="rounded-full border px-2 py-1 text-xs">BSQ n√ºmun…ôl…ôri</span>
              <span class="rounded-full border px-2 py-1 text-xs">Qrubla≈üdƒ±rma</span>
              <span class="rounded-full border px-2 py-1 text-xs">Rubrikalar</span>
              <span class="rounded-full border px-2 py-1 text-xs">ƒ∞llik plan</span>
              <span class="rounded-full border px-2 py-1 text-xs">G√ºnd…ôlik plan</span>
            </div>
            <button class="rounded-2xl w-full border px-4 py-2 text-sm" id="btn-browse">Bax</button>
          </div>
        </div>

        <div class="rounded-2xl shadow-sm hover:shadow-md transition border bg-white">
          <div class="p-4 border-b"><div class="text-base font-semibold">üìö <span id="tool-bank-title">Sual bankƒ±</span></div></div>
          <div class="p-4">
            <div class="grid grid-cols-2 gap-2 mb-3">
              <span class="rounded-full border px-2 py-1 text-xs text-center">Multiple choice</span>
              <span class="rounded-full border px-2 py-1 text-xs text-center">Qƒ±sa cavab</span>
              <span class="rounded-full border px-2 py-1 text-xs text-center">A√ßƒ±q sual</span>
              <span class="rounded-full border px-2 py-1 text-xs text-center">Praktik tap≈üƒ±rƒ±q</span>
            </div>
            <button class="rounded-2xl w-full bg-slate-900 text-white px-4 py-2 text-sm" id="btn-add">∆èlav…ô et</button>
          </div>
        </div>

        
      </div>
    </section>
  </main>

  <footer class="border-t border-slate-200 py-10 text-sm">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 flex flex-col sm:flex-row items-center justify-between gap-4">
      <p class="text-slate-600">¬© <span id="year"></span> EduPlan AZ ¬∑ <span id="ft-rights">B√ºt√ºn h√ºquqlar qorunur</span></p>
      <div class="flex items-center gap-4 text-slate-600">
        <a class="hover:underline" href="terms.html" id="ft-terms">≈û…ôrtl…ôr</a>
        <a class="hover:underline" href="privacy.html" id="ft-privacy">M…ôxfilik</a>
      </div>
    </div>
  </footer>

  <script>
    
  const translations = {
    az: {
      nav: { settings: 'T…ônziml…ôm…ôl…ôr', signIn: 'Daxil ol' },
      hero: {
        title: 'T…ôdris resurslarƒ±nƒ± saniy…ôl…ôr i√ßind…ô tap v…ô y√ºkl…ô',
        subtitle: 'Sad…ô interfeys, premium g√∂r√ºn√º≈ü, Az…ôrbaycan m…ôkt…ôbl…ôri √º√ß√ºn uyƒüunla≈üdƒ±rƒ±lƒ±b.',
        ctaPrimary: 'Yeni s…ôn…ôd', ctaSecondary: '≈ûablonlara bax',
        badges: { one: 'KSQ/BSQ & PP', two: 'Al…ôtl…ôr & Testl…ôr', three: 'PDF/DOCX' }
      },
      features: {
        ksqBsq: { title: 'KSQ/BSQ', desc: 'Sinif, f…ônn, n√∂v v…ô n√∂mr…ô √ºzr…ô summativ qiym…ôtl…ôndirm…ô fayllarƒ±.' },
        pp: { title: 'Perspektiv plan (PP)', desc: 'F…ônn √ºzr…ô illik plan fayllarƒ±.' },
        calc: 'Bal kalkulyatoru', templates: 'Sual bankƒ±', export: 'ƒ∞xrac'
      },
      tabs: { pp: 'Perspektiv plan', tools: 'Al…ôtl…ôr & Testl…ôr' },
      ksq: { title: 'KSQ/BSQ', type: 'N√∂v' },
      pp: { title: 'Perspektiv (illik) plan' },
      tools: { calcTitle: 'Bal kalkulyatoru', templatesTitle: '≈ûablon kitabxanasƒ±', bankTitle: 'Sual bankƒ±' },
      labels: { ksqNo: 'KSQ n√∂mr…ôsi', bsqNo: 'BSQ n√∂mr…ôsi' },
      common: { grade: 'Sinif', subject: 'F…ônn', calculate: 'Hesabla', browse: 'Bax', add: '∆èlav…ô et' },
      subjects: {
        az: 'Az…ôrbaycan dili', lit: '∆èd…ôbiyyat', science: 'T…ôbi…ôt', eng: 'ƒ∞ngilis dili', rus: 'Rus dili', math: 'Riyaziyyat',
        physics: 'Fizika', chemistry: 'Kimya', biology: 'Biologiya',
        az_history: 'Az…ôrbaycan tarixi', world_history: '√úmumi tarix', geography: 'Coƒürafiya',
        it: 'ƒ∞nformatika', life: 'H…ôyat bilgisi', tech: 'Texnologiya', art: 'T…ôsviri inc…ôs…ôn…ôt', music: 'Musiqi',
        pe: 'Fiziki t…ôrbiy…ô', premilitary: '√áaƒüƒ±rƒ±≈üaq…ôd…ôrki hazƒ±rlƒ±q',
      },
      footer: { rights: 'B√ºt√ºn h√ºquqlar qorunur', terms: '≈û…ôrtl…ôr', privacy: 'M…ôxfilik' },
    },
  };

  const subjectKeysByGrade = {
      I:  ['az','life','math','eng','rus','art','music','pe','tech','it'],
      II: ['az','life','math','eng','rus','art','music','pe','tech','it'],
      III:['az','life','math','eng','rus','art','music','pe','tech','it'],
      IV: ['az','life','math','eng','rus','art','music','pe','tech','it'],
      V:  ['az','lit','eng','rus','math','science','it','az_history','geography','art','music','pe','tech'],
      VI: ['az','lit','eng','rus','math','physics','science','it','az_history','geography','art','music','pe','tech'],
      VII:['az','lit','eng','rus','math','physics','chemistry','biology','az_history','world_history','geography','it','pe','art','music','tech'],
      VIII:['az','lit','eng','rus','math','physics','chemistry','biology','az_history','world_history','geography','it','pe','art','music','tech'],
      IX: ['az','lit','eng','rus','math','physics','chemistry','biology','az_history','world_history','geography','it','pe','art','music','tech'],
      X:  ['az','lit','eng','rus','math','physics','chemistry','biology','az_history','world_history','geography','it','pe','art','music','tech','premilitary'],
      XI: ['az','lit','eng','rus','math','physics','chemistry','biology','az_history','world_history','geography','it','pe','art','music','tech','premilitary'],
  };

  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

const state = {
  lang: 'az',
  grade: null,       // …ôvv…ôl 'V' idi ‚Üí bo≈ü
  subject: null,     // …ôvv…ôl null qalƒ±r
  ksqType: null,     // KSQ/BSQ se√ßilm…ôyib
  ksqIndex: null,
  bsqIndex: null,
  ppSubject: null,   // PP f…ônni d…ô se√ßilm…ôyib
  catalog: [],
};

  window.state = state;
    
function setActiveTab(name, opts = { scroll: false }) {
  // Tab d√ºym…ôl…ôrinin aktivliyi
  $$('.tab-btn').forEach(btn => {
    const act = btn.dataset.tab === name;
    btn.classList.toggle('bg-white', act);
    btn.classList.toggle('shadow-sm', act);
    btn.classList.toggle('text-slate-900', act);
    btn.classList.toggle('text-slate-600', !act);
    btn.setAttribute('aria-selected', act ? 'true' : 'false');
  });

  // Panell…ôri g√∂st…ôr/gizl…ôt + animasiya
  ['ksq','pp','tools'].forEach(n => {
    const panel = document.getElementById('panel-' + n);
    if (!panel) return;
    if (n === name) {
      panel.classList.add('is-active');
      // d√ºzg√ºn display √º√ß√ºn (grid olan panel √º√ß√ºn)
      if (panel.classList.contains('grid-on')) {
        panel.style.display = 'grid';
      } else {
        panel.style.display = 'block';
      }
      // panelin ba≈üƒ±na yum≈üaq scroll (ist…ôyin…ô g√∂r…ô)
      if (opts.scroll) {
        const y = panel.getBoundingClientRect().top + window.scrollY - 90;
        window.scrollTo({ top: y, behavior: 'smooth' });
      }
    } else {
      panel.classList.remove('is-active');
      panel.style.display = 'none';
    }
  });

  // i√ß scroll-u sƒ±fƒ±rla (vizuallƒ±q √º√ß√ºn)
  document.getElementById('ksq-results')?.scrollTo?.(0,0);
  document.getElementById('pp-results')?.scrollTo?.(0,0);
}

  function option(el, val, text){ const o=document.createElement('option'); o.value=val; o.textContent=text; el.appendChild(o);}  

  function subjectsFor(grade){
    const keys = subjectKeysByGrade[grade] || Object.keys(translations[state.lang].subjects);
    return keys.map(k => translations[state.lang].subjects[k]).filter(Boolean);
  }
  function setText(sel, text){
  const el = document.querySelector(sel);
  if (el) el.textContent = text;
}
    // --- GAS feed ---

function renderSelects(){
  const t = translations[state.lang];

  // === KSQ/BSQ select-l…ôri ===
  const grades = ['I','II','III','IV','V','VI','VII','VIII','IX','X','XI'];

  // Sinif
  const gradeEl = document.getElementById('grade');
  gradeEl.innerHTML = '';
  addPlaceholder(gradeEl, 'Sinfi se√ßin');
  grades.forEach(g => option(gradeEl, g, g));
  gradeEl.value = state.grade ?? "";

  // F…ônn (sinif se√ßilm…ôyibs…ô, yalnƒ±z placeholder)
  const subjEl = document.getElementById('subject');
  subjEl.innerHTML = '';
  addPlaceholder(subjEl, 'F…ônni se√ßin');
  if (state.grade){
    const S = subjectsFor(state.grade);
    S.forEach(s => option(subjEl, s, s));
  }
  subjEl.value = state.subject ?? "";

  // N√∂v (KSQ/BSQ)
  const typeEl = document.getElementById('ksqType');
  typeEl.innerHTML = '';
  addPlaceholder(typeEl, 'N√∂v√º se√ßin');
  option(typeEl, 'KSQ', 'KSQ');
  option(typeEl, 'BSQ', 'BSQ');
  typeEl.value = state.ksqType ?? "";

  // KSQ/BSQ n√∂mr…ôl…ôri ‚Äì yalnƒ±z n√∂v se√ßil…ônd…ôn sonra
  const kEl = document.getElementById('ksqIndex');
  const bEl = document.getElementById('bsqIndex');
  const wrapK = document.getElementById('wrap-ksqNo');
  const wrapB = document.getElementById('wrap-bsqNo');

  kEl.innerHTML = ''; bEl.innerHTML = '';
  addPlaceholder(kEl, 'N√∂mr…ôni se√ßin');
  addPlaceholder(bEl, 'N√∂mr…ôni se√ßin');

  if (state.ksqType === 'KSQ'){
    for (let i=1;i<=10;i++) option(kEl, String(i), String(i));
    wrapK.classList.remove('hidden');
    wrapB.classList.add('hidden');
    kEl.value = state.ksqIndex ?? "";
  } else if (state.ksqType === 'BSQ'){
    ['1','2'].forEach(i=> option(bEl, i, i));
    wrapK.classList.add('hidden');
    wrapB.classList.remove('hidden');
    bEl.value = state.bsqIndex ?? "";
  } else {
    // h…ôl…ô n√∂v se√ßilm…ôyibs…ô, h…ôr ikisini gizl…ôt
    wrapK.classList.add('hidden');
    wrapB.classList.add('hidden');
  }

  // === PP f…ônn ===
  const ppEl = document.getElementById('ppSubject');
  ppEl.innerHTML = '';
  addPlaceholder(ppEl, 'F…ônni se√ßin');
  Object.values(t.subjects).forEach(s => option(ppEl, s, s));
  ppEl.value = state.ppSubject ?? "";

  // === M…ôtnl…ôr (d…ôyi≈üm…ôyib ‚Äî s…ônin kodundakƒ± kimi) ===
  setText('#hero-title', t.hero.title);
  setText('#lbl-grade',   t.common.grade);
  setText('#lbl-subject', t.common.subject);
  setText('#lbl-type',    t.ksq.type);
  setText('#lbl-ksqNo',   t.labels.ksqNo);
  setText('#lbl-bsqNo',   t.labels.bsqNo);
  setText('#lbl-pp-subject', t.common.subject);

  setText('#ksq-title', t.ksq.title);
  setText('#pp-title',  t.pp.title);

  setText('#hero-subtitle', t.hero.subtitle);
  setText('#hero-b1', t.hero.badges.one);
  setText('#hero-b2', t.hero.badges.two);
  setText('#hero-b3', t.hero.badges.three);

  setText('#feat-ksq-title', t.features.ksqBsq.title);
  setText('#feat-ksq-desc',  t.features.ksqBsq.desc);
  setText('#feat-pp-title',  t.features.pp.title);
  setText('#feat-pp-desc',   t.features.pp.desc);

  setText('#tab-pp',    t.tabs.pp);
  setText('#tab-tools', t.tabs.tools);

  setText('#tool-calc-title',      t.tools.calcTitle);
  setText('#tool-templates-title', t.tools.templatesTitle);
  setText('#tool-bank-title',      t.tools.bankTitle);

  setText('#ft-rights',  t.footer.rights);
  setText('#ft-terms',   t.footer.terms);
  setText('#ft-privacy', t.footer.privacy);
  setText('[data-i18n="nav.settings"]', t.nav.settings);
}


  // Kart ba≈ülƒ±ƒüƒ±nƒ± formala≈üdƒ±rƒ±r
function buildTitle(it) {
  const format = (it.ext || 'FILE').toUpperCase();
  if (it.type === 'PP') {
    const subject = it.subject || 'F…ônn';
    return `${subject} ¬∑ PP ¬∑ ${format}`;
  }
  const grade   = it.grade   || '‚Äî';
  const subject = it.subject || 'F…ônn';
  const idx     = it.index   || '';
  return `${grade} ¬∑ ${subject} ¬∑ ${it.type}-${idx} ¬∑ ${format}`;
}


document.getElementById('grade').addEventListener('change', e=>{
  state.grade = e.target.value || null;
  // sinif d…ôyi≈üdis…ô, f…ônni sƒ±fƒ±rla
  state.subject = null;
  renderSelects();
  toggleResults();
});

document.getElementById('subject').addEventListener('change', e=>{
  state.subject = e.target.value || null;
  toggleResults();
});

document.getElementById('ksqType').addEventListener('change', e=>{
  state.ksqType = e.target.value || null;
  // n√∂mr…ôl…ôri sƒ±fƒ±rla
  state.ksqIndex = null;
  state.bsqIndex = null;
  renderSelects();
  toggleResults();
});

document.getElementById('ksqIndex').addEventListener('change', e=>{
  state.ksqIndex = e.target.value || null;
  toggleResults();
});

document.getElementById('bsqIndex').addEventListener('change', e=>{
  state.bsqIndex = e.target.value || null;
  toggleResults();
});

document.getElementById('ppSubject').addEventListener('change', e=>{
  state.ppSubject = e.target.value || null;
  toggleResults();
});


  ['tab-ksq','tab-pp','tab-tools'].forEach(id => {
  const btn = document.getElementById(id);
  if (!btn) return;
btn.addEventListener('click', (e) => {
  const name = e.currentTarget.dataset.tab;
  setActiveTab(name, { scroll: true }); // klikd…ô scroll et
});

});
(function init(){
  document.getElementById('year').textContent = new Date().getFullYear();
  if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
  window.scrollTo(0, 0);
  setActiveTab('ksq', { scroll: false });

  // ARTƒ∞Q avtomatik se√ßim YOXDUR
  // state.subject = ...  ‚Üê sil
  // state.ppSubject = ... ‚Üê sil

  renderSelects();
  toggleResults();
})();

    
  const settingsBtn = document.getElementById('btn-settings');
  const panel = document.getElementById('settings-panel');
  const darkToggle = document.getElementById('dark-toggle');
// Sistem ayarƒ±nƒ± da n…ôz…ôr…ô al
const mq = window.matchMedia('(prefers-color-scheme: dark)');

// LocalStorage-da yoxdursa, sistemi g√∂t√ºr
const saved = localStorage.getItem('theme');
const initialTheme = saved ? saved : (mq.matches ? 'dark' : 'light');

// T…ôtbiq et
document.documentElement.classList.toggle('dark', initialTheme === 'dark');
if (darkToggle) darkToggle.checked = (initialTheme === 'dark');
applyThemeAssets(initialTheme);

// Toggle d…ôyi≈ü…ônd…ô
darkToggle?.addEventListener('change', (e) => {
  const theme = e.target.checked ? 'dark' : 'light';
  document.documentElement.classList.toggle('dark', theme === 'dark');
  localStorage.setItem('theme', theme);
  applyThemeAssets(theme);
});

// ƒ∞stifad…ô√ßi localStorage-da se√ßim etm…ôyibs…ô, sistem temasƒ± d…ôyi≈ü…ônd…ô uyƒüunla≈ü
mq.addEventListener?.('change', (e) => {
  if (!localStorage.getItem('theme')) {
    const theme = e.matches ? 'dark' : 'light';
    document.documentElement.classList.toggle('dark', theme === 'dark');
    if (darkToggle) darkToggle.checked = (theme === 'dark');
    applyThemeAssets(theme);
  }
});

  // paneli a√ß/baƒüla
  settingsBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    panel.classList.toggle('hidden');
  });

  // k…ônara klik = baƒüla
  document.addEventListener('click', (e) => {
    if (!panel.contains(e.target) && !settingsBtn.contains(e.target)) {
      panel.classList.add('hidden');
    }
  });
function applyThemeAssets(theme) {
  const isDark = theme === 'dark';

  // Header loqo ‚Äî favicon deyil, loqo fayllarƒ±
  const logoEl = document.getElementById('site-logo');
  if (logoEl) {
    logoEl.src = isDark ? 'assets/ep-favicon-dark.svg' : 'assets/ep-favicon-light.svg';
  }

  // Apple Touch Icon (mobil √º√ß√ºn)
  const apple = document.getElementById('apple-icon');
  if (apple) {
    apple.href = isDark ? 'assets/ep-favicon-dark.svg' : 'assets/ep-favicon-light.svg';
  }
}



const FEED_URL = "https://script.google.com/macros/s/AKfycbxnt6tDu5YJ_P_FUgobNTu_Q-2dbyZjaXSWwyjIKysTJ3UwnWZKqm0ZxoNwoyT4M0w7/exec";

// Kart ba≈ülƒ±ƒüƒ±
function buildTitle(it){
  const format = (it.ext || 'FILE').toUpperCase();
  return it.type==='PP'
    ? `${it.subject} ¬∑ PP ¬∑ ${format}`
    : `${it.grade} ¬∑ ${it.subject} ¬∑ ${it.type}-${it.index} ¬∑ ${format}`;
}

// G√∂st…ôril…ôc…ôk fayl adƒ± (ist…ôs…ôn saxla)
function downloadName(it){
  const ext = (it.ext || 'FILE').toLowerCase();
  return (it.type==='PP'
    ? `${it.subject} - PP.${ext}`
    : `${it.grade} - ${it.subject} - ${it.type}${it.index}.${ext}`
  ).replace(/[\/\\:?*"<>|]+/g,'-');
}

function renderKSQ(){
  const wrap = document.getElementById('ksq-results');
  wrap.innerHTML = '';

  // Filtrl…ôm…ô
  const list = window.state.catalog.filter(it=>{
    if (it.type !== state.ksqType) return false;
    if (it.type !== 'PP' && it.grade !== state.grade) return false;
    if (it.type !== 'PP' && it.subject !== state.subject) return false;
    if (state.ksqType === 'KSQ' && it.index !== state.ksqIndex) return false;
    if (state.ksqType === 'BSQ' && it.index !== state.bsqIndex) return false;
    return true;
  });

  // Sayƒ± g√∂st…ôr
  document.getElementById('ksq-count').textContent = list.length;

// 1‚Äì2 n…ôtic…ô varsa ortala (wrap + grid)
const wrapEl = document.getElementById('ksq-results-wrap');
const gridEl = document.getElementById('ksq-results');
const center = (list.length > 0 && list.length <= 2);

if (wrapEl && gridEl) {
  // kart sah…ôsinin √∂z√ºn√º m…ôrk…ôzl…ô≈üdir
  wrapEl.classList.toggle('flex', center);
  wrapEl.classList.toggle('items-center', center);
  wrapEl.classList.toggle('justify-center', center);
  wrapEl.classList.toggle('min-h-[240px]', center);

  // grid elementl…ôrinin i√ß m…ôrk…ôzl…ô≈üm…ôsi
  gridEl.classList.toggle('place-content-center', center);
  gridEl.classList.toggle('justify-items-center', center);

  if (!center) {
    wrapEl.classList.remove('flex','items-center','justify-center','min-h-[240px]');
    gridEl.classList.remove('place-content-center','justify-items-center');
  }
}


  // N…ôtic…ô yoxdursa
  if (list.length === 0) {
    wrap.innerHTML = '<div class="rounded-lg border border-dashed border-slate-300 p-6 text-slate-500">Fayl yoxdur</div>';
    return;
  }

  // Kartlarƒ± √ß…ôk
  list.forEach(it=>{
    const card = document.createElement('div');
    card.className = 'group rounded-xl p-[1px] bg-gradient-to-br from-slate-200 to-slate-100';
    card.innerHTML = `
      <div class="rounded-[11px] p-4 bg-white shadow-sm group-hover:shadow-md transition">
        <div class="flex items-start gap-3">
          <div class="h-8 w-8 rounded-lg bg-slate-100 grid place-items-center">üìÑ</div>
          <div class="flex-1">
            <div class="text-sm font-medium">${buildTitle(it)}</div>
            <div class="mt-1"><span class="rounded-full bg-slate-100 px-2 py-0.5 text-[10px] border">${(it.ext || 'FILE').toUpperCase()}</span></div>
            <div class="mt-3">
              <a href="${it.dl}"
                 target="_self" rel="noopener"
                 download="${downloadName(it)}"
                 class="rounded-2xl bg-slate-900 text-white px-3 py-1.5 text-sm inline-flex items-center gap-2">‚¨áÔ∏è Y√ºkl…ô</a>
            </div>
          </div>
        </div>
      </div>`;
    wrap.appendChild(card);
  });
}


function renderPP(){
  const wrap = document.getElementById('pp-results');
  wrap.innerHTML = '';

  const list = window.state.catalog.filter(it => it.type==='PP' && it.subject===state.ppSubject);

  document.getElementById('pp-count').textContent = list.length;

// 1‚Äì2 n…ôtic…ô varsa ortala (wrap + grid)
const wrapEl = document.getElementById('pp-results-wrap');
const gridEl = document.getElementById('pp-results');
const center = (list.length > 0 && list.length <= 2);

if (wrapEl && gridEl) {
  wrapEl.classList.toggle('flex', center);
  wrapEl.classList.toggle('items-center', center);
  wrapEl.classList.toggle('justify-center', center);
  wrapEl.classList.toggle('min-h-[240px]', center);

  gridEl.classList.toggle('place-content-center', center);
  gridEl.classList.toggle('justify-items-center', center);

  if (!center) {
    wrapEl.classList.remove('flex','items-center','justify-center','min-h-[240px]');
    gridEl.classList.remove('place-content-center','justify-items-center');
  }
}


  if (list.length === 0) {
    wrap.innerHTML = '<div class="rounded-lg border border-dashed border-slate-300 p-6 text-slate-500">Fayl yoxdur</div>';
    return;
  }

  list.forEach(it=>{
    const card = document.createElement('div');
    card.className = 'group rounded-xl p-[1px] bg-gradient-to-br from-slate-200 to-slate-100';
    card.innerHTML = `
      <div class="rounded-[11px] p-4 bg-white shadow-sm group-hover:shadow-md transition">
        <div class="flex items-start gap-3">
          <div class="h-8 w-8 rounded-lg bg-slate-100 grid place-items-center">üìÑ</div>
          <div class="flex-1">
            <div class="text-sm font-medium">${buildTitle(it)}</div>
            <div class="mt-1"><span class="rounded-full bg-slate-100 px-2 py-0.5 text-[10px] border">${(it.ext || 'FILE').toUpperCase()}</span></div>
            <div class="mt-3">
              <a href="${it.dl}"
                 target="_self" rel="noopener"
                 download="${downloadName(it)}"
                 class="rounded-2xl bg-slate-900 text-white px-3 py-1.5 text-sm inline-flex items-center gap-2">‚¨áÔ∏è Y√ºkl…ô</a>
            </div>
          </div>
        </div>
      </div>`;
    wrap.appendChild(card);
  });
}




async function loadAllFromMaterials() {
  const wrapKSQ = document.getElementById('ksq-results');
  const wrapPP  = document.getElementById('pp-results');
  if (wrapKSQ) wrapKSQ.innerHTML = '<div class="text-slate-500">Y√ºkl…ônir‚Ä¶</div>';
  if (wrapPP)  wrapPP.innerHTML  = '<div class="text-slate-500">Y√ºkl…ônir‚Ä¶</div>';

  try {
  const res = await fetch(FEED_URL, { cache: 'no-store' });
  const catalog = await res.json();
  state.catalog = Array.isArray(catalog) ? catalog : [];
    renderSelects(); 
    toggleResults();
  } catch (e) {
    const msg = `<div class="rounded-lg border border-dashed border-slate-300 p-6 text-slate-500">X…ôta: ${e.message}</div>`;
    if (wrapKSQ) wrapKSQ.innerHTML = msg;
    if (wrapPP)  wrapPP.innerHTML  = msg;
  }
}

document.addEventListener('DOMContentLoaded', () => {
  renderSelects();
  loadAllFromMaterials();
});
function addPlaceholder(selectEl, label){
  const o = document.createElement('option');
  o.value = "";
  o.textContent = label;
  o.disabled = true;
  o.selected = true;
  o.hidden = true;
  selectEl.appendChild(o);
  selectEl.required = true; // :invalid i≈ül…ôsin
}

function allChosenKSQ(){
  if (!state.grade || !state.subject || !state.ksqType) return false;
  if (state.ksqType === 'KSQ' && !state.ksqIndex) return false;
  if (state.ksqType === 'BSQ' && !state.bsqIndex) return false;
  return true;
}
function allChosenPP(){
  return !!state.ppSubject;
}

function toggleResults(){
  // KSQ/BSQ
  const boxKSQ = document.getElementById('ksq-results');
  if (boxKSQ){
    if (allChosenKSQ()){
      renderKSQ();
      boxKSQ.parentElement.removeAttribute('hidden');
    } else {
      boxKSQ.innerHTML = '<div class="rounded-lg border border-dashed border-slate-300 p-6 text-slate-500">Z…ôhm…ôt olmasa sinif, f…ônn, n√∂v v…ô n√∂mr…ôni se√ßin</div>';
      boxKSQ.parentElement.setAttribute('hidden','');
    }
  }
  // PP
  const boxPP = document.getElementById('pp-results');
  if (boxPP){
    if (allChosenPP()){
      renderPP();
      boxPP.parentElement.removeAttribute('hidden');
    } else {
      boxPP.innerHTML = '<div class="rounded-lg border border-dashed border-slate-300 p-6 text-slate-500">Z…ôhm…ôt olmasa f…ônni se√ßin</div>';
      boxPP.parentElement.setAttribute('hidden','');
    }
  }
}





  </script>

</body>
</html>
